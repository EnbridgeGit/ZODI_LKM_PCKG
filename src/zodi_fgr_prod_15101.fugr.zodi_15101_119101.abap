FUNCTION ZODI_15101_119101.
*"--------------------------------------------------------------------
*"*"Local Interface:
*"  IMPORTING
*"     VALUE(IV_DELIMITER) TYPE  CHAR3
*"     VALUE(IV_FILENAME) TYPE  CHAR255
*"     VALUE(IV_USER) TYPE  CHAR35
*"     VALUE(IV_PWD) TYPE  CHAR35
*"     VALUE(IV_HOST) TYPE  CHAR35
*"     VALUE(IV_HASHVALUE) TYPE  CHAR35
*"     VALUE(IV_PATH) TYPE  CHAR35
*"     VALUE(IV_MAX_ROW_CNT) TYPE  SYTABIX
*"     VALUE(IV_FETCH_BATCH_SIZE) TYPE  SYTABIX
*"     VALUE(IV_P_LANGUAGE_CODE) TYPE  STRING
*"     VALUE(IV_P_LEDGER_CODE) TYPE  STRING
*"     VALUE(IV_P_YEAR) TYPE  STRING
*"     VALUE(IV_P_RECORD_TYPE) TYPE  STRING
*"  TABLES
*"      RETURN STRUCTURE  BAPIRETURN
*"      ET_FILE_RETURN STRUCTURE  BAPIRET2
*"--------------------------------------------------------------------



************************
*Final Type declarations
************************
TYPES : BEGIN OF ty_final,

D1_LAND1 TYPE
 T001-LAND1,
D2_LAND1 TYPE
 T005-LAND1,
D3_WAERS TYPE
 T001-WAERS,
D4_WAERS TYPE
 TCURT-WAERS,
D5_BUKRS TYPE
 T001-BUKRS,
D6_RBUKRS TYPE
 FAGLFLEXT-RBUKRS,
D7_RCLNT TYPE
 FAGLFLEXT-RCLNT,
D8_MANDT TYPE
 T000-MANDT,
C1_BUTXT TYPE
 T001-BUTXT,
C2_FIKRS TYPE
 T001-FIKRS,
C4_KTOPL TYPE
 T001-KTOPL,
C5_LTEXT TYPE
 TCURT-LTEXT,
C7_RBUSA TYPE
 FAGLFLEXT-RBUSA,
C8_RFAREA TYPE
 FAGLFLEXT-RFAREA,
C9_SEGMENT TYPE
 FAGLFLEXT-SEGMENT,
C10_PRCTR TYPE
 FAGLFLEXT-PRCTR,
C11_RASSC TYPE
 FAGLFLEXT-RASSC,
C12_RYEAR TYPE
 FAGLFLEXT-RYEAR,
C13_SBUSA TYPE
 FAGLFLEXT-SBUSA,
C14_SFAREA TYPE
 FAGLFLEXT-SFAREA,
C15_PPRCTR TYPE
 FAGLFLEXT-PPRCTR,
C16_RPMAX TYPE
 FAGLFLEXT-RPMAX,
C17_RACCT TYPE
 FAGLFLEXT-RACCT,
C18_RVERS TYPE
 FAGLFLEXT-RVERS,
C19_RLDNR TYPE
 FAGLFLEXT-RLDNR,
C20_LOGSYS TYPE
 FAGLFLEXT-LOGSYS,
C21_COST_ELEM TYPE
 FAGLFLEXT-COST_ELEM,
C22_RCNTR TYPE
 FAGLFLEXT-RCNTR,
C23_KOKRS TYPE
 FAGLFLEXT-KOKRS,
C24_HSL01 TYPE
 FAGLFLEXT-HSL01,
C25_HSL02 TYPE
 FAGLFLEXT-HSL02,
C26_HSL03 TYPE
 FAGLFLEXT-HSL03,
C27_HSL04 TYPE
 FAGLFLEXT-HSL04,
C28_HSL05 TYPE
 FAGLFLEXT-HSL05,
C29_HSL06 TYPE
 FAGLFLEXT-HSL06,
C30_HSL07 TYPE
 FAGLFLEXT-HSL07,
C31_HSL08 TYPE
 FAGLFLEXT-HSL08,
C32_HSL09 TYPE
 FAGLFLEXT-HSL09,
C33_HSL10 TYPE
 FAGLFLEXT-HSL10,
C34_HSL11 TYPE
 FAGLFLEXT-HSL11,
C35_HSL12 TYPE
 FAGLFLEXT-HSL12,
C36_HSL13 TYPE
 FAGLFLEXT-HSL13,
C37_HSL14 TYPE
 FAGLFLEXT-HSL14,
C38_HSL15 TYPE
 FAGLFLEXT-HSL15,
C39_HSL16 TYPE
 FAGLFLEXT-HSL16,
C40_DRCRK TYPE
 FAGLFLEXT-DRCRK,
C41_HSLVT TYPE
 FAGLFLEXT-HSLVT,
C42_TSLVT TYPE
 FAGLFLEXT-TSLVT,
C43_KSLVT TYPE
 FAGLFLEXT-KSLVT,
C44_RTCUR TYPE
 FAGLFLEXT-RTCUR,
C45_TSL05 TYPE
 FAGLFLEXT-TSL05,
C46_TSL01 TYPE
 FAGLFLEXT-TSL01,
C47_TSL06 TYPE
 FAGLFLEXT-TSL06,
C48_TSL02 TYPE
 FAGLFLEXT-TSL02,
C49_TSL04 TYPE
 FAGLFLEXT-TSL04,
C50_TSL03 TYPE
 FAGLFLEXT-TSL03,
C51_TSL07 TYPE
 FAGLFLEXT-TSL07,
C52_TSL12 TYPE
 FAGLFLEXT-TSL12,
C53_TSL08 TYPE
 FAGLFLEXT-TSL08,
C54_TSL11 TYPE
 FAGLFLEXT-TSL11,
C55_TSL09 TYPE
 FAGLFLEXT-TSL09,
C56_TSL10 TYPE
 FAGLFLEXT-TSL10,
C57_TSL13 TYPE
 FAGLFLEXT-TSL13,
C58_TSL16 TYPE
 FAGLFLEXT-TSL16,
C59_TSL14 TYPE
 FAGLFLEXT-TSL14,
C60_TSL15 TYPE
 FAGLFLEXT-TSL15,
C61_RRCTY TYPE
 FAGLFLEXT-RRCTY,
C62_KSL11 TYPE
 FAGLFLEXT-KSL11,
C63_KSL02 TYPE
 FAGLFLEXT-KSL02,
C64_KSL10 TYPE
 FAGLFLEXT-KSL10,
C65_KSL15 TYPE
 FAGLFLEXT-KSL15,
C66_KSL07 TYPE
 FAGLFLEXT-KSL07,
C67_KSL09 TYPE
 FAGLFLEXT-KSL09,
C68_KSL03 TYPE
 FAGLFLEXT-KSL03,
C69_KSL08 TYPE
 FAGLFLEXT-KSL08,
C70_KSL14 TYPE
 FAGLFLEXT-KSL14,
C71_KSL04 TYPE
 FAGLFLEXT-KSL04,
C72_KSL05 TYPE
 FAGLFLEXT-KSL05,
C73_KSL01 TYPE
 FAGLFLEXT-KSL01,
C74_KSL12 TYPE
 FAGLFLEXT-KSL12,
C75_KSL13 TYPE
 FAGLFLEXT-KSL13,
C76_KSL06 TYPE
 FAGLFLEXT-KSL06,
C77_KSL16 TYPE
 FAGLFLEXT-KSL16,
C79_MWAER TYPE
 T000-MWAER,
C80_OBJNR00 TYPE
 FAGLFLEXT-OBJNR00,
C81_OBJNR01 TYPE
 FAGLFLEXT-OBJNR01,
C82_OBJNR02 TYPE
 FAGLFLEXT-OBJNR02,
C83_OBJNR03 TYPE
 FAGLFLEXT-OBJNR03,
C84_OBJNR04 TYPE
 FAGLFLEXT-OBJNR04,
C85_OBJNR05 TYPE
 FAGLFLEXT-OBJNR05,
C86_OBJNR06 TYPE
 FAGLFLEXT-OBJNR06,
C87_OBJNR07 TYPE
 FAGLFLEXT-OBJNR07,
C88_OBJNR08 TYPE
 FAGLFLEXT-OBJNR08,
C89_ACTIV TYPE
 FAGLFLEXT-ACTIV,
C90_RMVCT TYPE
 FAGLFLEXT-RMVCT,
C91_RUNIT TYPE
 FAGLFLEXT-RUNIT,
C92_AWTYP TYPE
 FAGLFLEXT-AWTYP,
C93_SCNTR TYPE
 FAGLFLEXT-SCNTR,
C94_PSEGMENT TYPE
 FAGLFLEXT-PSEGMENT,
C95_OSLVT TYPE
 FAGLFLEXT-OSLVT,
C96_OSL01 TYPE
 FAGLFLEXT-OSL01,
C97_OSL02 TYPE
 FAGLFLEXT-OSL02,
C98_OSL03 TYPE
 FAGLFLEXT-OSL03,
C99_OSL04 TYPE
 FAGLFLEXT-OSL04,
C100_OSL05 TYPE
 FAGLFLEXT-OSL05,
C101_OSL06 TYPE
 FAGLFLEXT-OSL06,
C102_OSL07 TYPE
 FAGLFLEXT-OSL07,
C103_OSL08 TYPE
 FAGLFLEXT-OSL08,
C104_OSL09 TYPE
 FAGLFLEXT-OSL09,
C105_OSL10 TYPE
 FAGLFLEXT-OSL10,
C106_OSL11 TYPE
 FAGLFLEXT-OSL11,
C107_OSL12 TYPE
 FAGLFLEXT-OSL12,
C108_OSL13 TYPE
 FAGLFLEXT-OSL13,
C109_OSL14 TYPE
 FAGLFLEXT-OSL14,
C110_OSL15 TYPE
 FAGLFLEXT-OSL15,
C111_OSL16 TYPE
 FAGLFLEXT-OSL16,
C112_MSLVT TYPE
 FAGLFLEXT-MSLVT,
C113_MSL01 TYPE
 FAGLFLEXT-MSL01,
C114_MSL02 TYPE
 FAGLFLEXT-MSL02,
C115_MSL03 TYPE
 FAGLFLEXT-MSL03,
C116_MSL04 TYPE
 FAGLFLEXT-MSL04,
C117_MSL05 TYPE
 FAGLFLEXT-MSL05,
C118_MSL06 TYPE
 FAGLFLEXT-MSL06,
C119_MSL07 TYPE
 FAGLFLEXT-MSL07,
C120_MSL08 TYPE
 FAGLFLEXT-MSL08,
C121_MSL09 TYPE
 FAGLFLEXT-MSL09,
C122_MSL10 TYPE
 FAGLFLEXT-MSL10,
C123_MSL11 TYPE
 FAGLFLEXT-MSL11,
C124_MSL12 TYPE
 FAGLFLEXT-MSL12,
C125_MSL13 TYPE
 FAGLFLEXT-MSL13,
C126_MSL14 TYPE
 FAGLFLEXT-MSL14,
C127_MSL15 TYPE
 FAGLFLEXT-MSL15,
C128_MSL16 TYPE
 FAGLFLEXT-MSL16,
C129_TIMESTAMP TYPE
 FAGLFLEXT-TIMESTAMP,
C130_CURIN TYPE
 T005-CURIN,
C131_CURHA TYPE
 T005-CURHA,
C132_WAERS TYPE
 T005-WAERS,
END OF ty_final.
*****************************
*Final Temp Type Declarations
*****************************
TYPES : BEGIN OF ty_final_tmp,

C1_BUTXT TYPE
 T001-BUTXT,
C2_FIKRS TYPE
 T001-FIKRS,
D3_WAERS TYPE
 T001-WAERS,
C4_KTOPL TYPE
 T001-KTOPL,
C5_LTEXT TYPE
 TCURT-LTEXT,
D6_RBUKRS TYPE
 FAGLFLEXT-RBUKRS,
C7_RBUSA TYPE
 FAGLFLEXT-RBUSA,
C8_RFAREA TYPE
 FAGLFLEXT-RFAREA,
C9_SEGMENT TYPE
 FAGLFLEXT-SEGMENT,
C10_PRCTR TYPE
 FAGLFLEXT-PRCTR,
C11_RASSC TYPE
 FAGLFLEXT-RASSC,
C12_RYEAR TYPE
 FAGLFLEXT-RYEAR,
C13_SBUSA TYPE
 FAGLFLEXT-SBUSA,
C14_SFAREA TYPE
 FAGLFLEXT-SFAREA,
C15_PPRCTR TYPE
 FAGLFLEXT-PPRCTR,
C16_RPMAX TYPE
 FAGLFLEXT-RPMAX,
C17_RACCT TYPE
 FAGLFLEXT-RACCT,
C18_RVERS TYPE
 FAGLFLEXT-RVERS,
C19_RLDNR TYPE
 FAGLFLEXT-RLDNR,
C20_LOGSYS TYPE
 FAGLFLEXT-LOGSYS,
C21_COST_ELEM TYPE
 FAGLFLEXT-COST_ELEM,
C22_RCNTR TYPE
 FAGLFLEXT-RCNTR,
C23_KOKRS TYPE
 FAGLFLEXT-KOKRS,
C24_HSL01 TYPE
 FAGLFLEXT-HSL01,
C25_HSL02 TYPE
 FAGLFLEXT-HSL02,
C26_HSL03 TYPE
 FAGLFLEXT-HSL03,
C27_HSL04 TYPE
 FAGLFLEXT-HSL04,
C28_HSL05 TYPE
 FAGLFLEXT-HSL05,
C29_HSL06 TYPE
 FAGLFLEXT-HSL06,
C30_HSL07 TYPE
 FAGLFLEXT-HSL07,
C31_HSL08 TYPE
 FAGLFLEXT-HSL08,
C32_HSL09 TYPE
 FAGLFLEXT-HSL09,
C33_HSL10 TYPE
 FAGLFLEXT-HSL10,
C34_HSL11 TYPE
 FAGLFLEXT-HSL11,
C35_HSL12 TYPE
 FAGLFLEXT-HSL12,
C36_HSL13 TYPE
 FAGLFLEXT-HSL13,
C37_HSL14 TYPE
 FAGLFLEXT-HSL14,
C38_HSL15 TYPE
 FAGLFLEXT-HSL15,
C39_HSL16 TYPE
 FAGLFLEXT-HSL16,
C40_DRCRK TYPE
 FAGLFLEXT-DRCRK,
C41_HSLVT TYPE
 FAGLFLEXT-HSLVT,
C42_TSLVT TYPE
 FAGLFLEXT-TSLVT,
C43_KSLVT TYPE
 FAGLFLEXT-KSLVT,
C44_RTCUR TYPE
 FAGLFLEXT-RTCUR,
C45_TSL05 TYPE
 FAGLFLEXT-TSL05,
C46_TSL01 TYPE
 FAGLFLEXT-TSL01,
C47_TSL06 TYPE
 FAGLFLEXT-TSL06,
C48_TSL02 TYPE
 FAGLFLEXT-TSL02,
C49_TSL04 TYPE
 FAGLFLEXT-TSL04,
C50_TSL03 TYPE
 FAGLFLEXT-TSL03,
C51_TSL07 TYPE
 FAGLFLEXT-TSL07,
C52_TSL12 TYPE
 FAGLFLEXT-TSL12,
C53_TSL08 TYPE
 FAGLFLEXT-TSL08,
C54_TSL11 TYPE
 FAGLFLEXT-TSL11,
C55_TSL09 TYPE
 FAGLFLEXT-TSL09,
C56_TSL10 TYPE
 FAGLFLEXT-TSL10,
C57_TSL13 TYPE
 FAGLFLEXT-TSL13,
C58_TSL16 TYPE
 FAGLFLEXT-TSL16,
C59_TSL14 TYPE
 FAGLFLEXT-TSL14,
C60_TSL15 TYPE
 FAGLFLEXT-TSL15,
C61_RRCTY TYPE
 FAGLFLEXT-RRCTY,
C62_KSL11 TYPE
 FAGLFLEXT-KSL11,
C63_KSL02 TYPE
 FAGLFLEXT-KSL02,
C64_KSL10 TYPE
 FAGLFLEXT-KSL10,
C65_KSL15 TYPE
 FAGLFLEXT-KSL15,
C66_KSL07 TYPE
 FAGLFLEXT-KSL07,
C67_KSL09 TYPE
 FAGLFLEXT-KSL09,
C68_KSL03 TYPE
 FAGLFLEXT-KSL03,
C69_KSL08 TYPE
 FAGLFLEXT-KSL08,
C70_KSL14 TYPE
 FAGLFLEXT-KSL14,
C71_KSL04 TYPE
 FAGLFLEXT-KSL04,
C72_KSL05 TYPE
 FAGLFLEXT-KSL05,
C73_KSL01 TYPE
 FAGLFLEXT-KSL01,
C74_KSL12 TYPE
 FAGLFLEXT-KSL12,
C75_KSL13 TYPE
 FAGLFLEXT-KSL13,
C76_KSL06 TYPE
 FAGLFLEXT-KSL06,
C77_KSL16 TYPE
 FAGLFLEXT-KSL16,
D7_RCLNT TYPE
 FAGLFLEXT-RCLNT,
C79_MWAER TYPE
 T000-MWAER,
C80_OBJNR00 TYPE
 FAGLFLEXT-OBJNR00,
C81_OBJNR01 TYPE
 FAGLFLEXT-OBJNR01,
C82_OBJNR02 TYPE
 FAGLFLEXT-OBJNR02,
C83_OBJNR03 TYPE
 FAGLFLEXT-OBJNR03,
C84_OBJNR04 TYPE
 FAGLFLEXT-OBJNR04,
C85_OBJNR05 TYPE
 FAGLFLEXT-OBJNR05,
C86_OBJNR06 TYPE
 FAGLFLEXT-OBJNR06,
C87_OBJNR07 TYPE
 FAGLFLEXT-OBJNR07,
C88_OBJNR08 TYPE
 FAGLFLEXT-OBJNR08,
C89_ACTIV TYPE
 FAGLFLEXT-ACTIV,
C90_RMVCT TYPE
 FAGLFLEXT-RMVCT,
C91_RUNIT TYPE
 FAGLFLEXT-RUNIT,
C92_AWTYP TYPE
 FAGLFLEXT-AWTYP,
C93_SCNTR TYPE
 FAGLFLEXT-SCNTR,
C94_PSEGMENT TYPE
 FAGLFLEXT-PSEGMENT,
C95_OSLVT TYPE
 FAGLFLEXT-OSLVT,
C96_OSL01 TYPE
 FAGLFLEXT-OSL01,
C97_OSL02 TYPE
 FAGLFLEXT-OSL02,
C98_OSL03 TYPE
 FAGLFLEXT-OSL03,
C99_OSL04 TYPE
 FAGLFLEXT-OSL04,
C100_OSL05 TYPE
 FAGLFLEXT-OSL05,
C101_OSL06 TYPE
 FAGLFLEXT-OSL06,
C102_OSL07 TYPE
 FAGLFLEXT-OSL07,
C103_OSL08 TYPE
 FAGLFLEXT-OSL08,
C104_OSL09 TYPE
 FAGLFLEXT-OSL09,
C105_OSL10 TYPE
 FAGLFLEXT-OSL10,
C106_OSL11 TYPE
 FAGLFLEXT-OSL11,
C107_OSL12 TYPE
 FAGLFLEXT-OSL12,
C108_OSL13 TYPE
 FAGLFLEXT-OSL13,
C109_OSL14 TYPE
 FAGLFLEXT-OSL14,
C110_OSL15 TYPE
 FAGLFLEXT-OSL15,
C111_OSL16 TYPE
 FAGLFLEXT-OSL16,
C112_MSLVT TYPE
 FAGLFLEXT-MSLVT,
C113_MSL01 TYPE
 FAGLFLEXT-MSL01,
C114_MSL02 TYPE
 FAGLFLEXT-MSL02,
C115_MSL03 TYPE
 FAGLFLEXT-MSL03,
C116_MSL04 TYPE
 FAGLFLEXT-MSL04,
C117_MSL05 TYPE
 FAGLFLEXT-MSL05,
C118_MSL06 TYPE
 FAGLFLEXT-MSL06,
C119_MSL07 TYPE
 FAGLFLEXT-MSL07,
C120_MSL08 TYPE
 FAGLFLEXT-MSL08,
C121_MSL09 TYPE
 FAGLFLEXT-MSL09,
C122_MSL10 TYPE
 FAGLFLEXT-MSL10,
C123_MSL11 TYPE
 FAGLFLEXT-MSL11,
C124_MSL12 TYPE
 FAGLFLEXT-MSL12,
C125_MSL13 TYPE
 FAGLFLEXT-MSL13,
C126_MSL14 TYPE
 FAGLFLEXT-MSL14,
C127_MSL15 TYPE
 FAGLFLEXT-MSL15,
C128_MSL16 TYPE
 FAGLFLEXT-MSL16,
C129_TIMESTAMP TYPE
 FAGLFLEXT-TIMESTAMP,
C130_CURIN TYPE
 T005-CURIN,
C131_CURHA TYPE
 T005-CURHA,
C132_WAERS TYPE
 T005-WAERS,
END OF ty_final_tmp.
*******************************
*Final Target Type Declarations
*******************************
TYPES : BEGIN OF ty_final_target,

C1_BUTXT TYPE
 T001-BUTXT,
C2_FIKRS TYPE
 T001-FIKRS,
C3_WAERS TYPE
 T001-WAERS,
C4_KTOPL TYPE
 T001-KTOPL,
C5_LTEXT TYPE
 TCURT-LTEXT,
C6_RBUKRS TYPE
 FAGLFLEXT-RBUKRS,
C7_RBUSA TYPE
 FAGLFLEXT-RBUSA,
C8_RFAREA TYPE
 FAGLFLEXT-RFAREA,
C9_SEGMENT TYPE
 FAGLFLEXT-SEGMENT,
C10_PRCTR TYPE
 FAGLFLEXT-PRCTR,
C11_RASSC TYPE
 FAGLFLEXT-RASSC,
C12_RYEAR TYPE
 FAGLFLEXT-RYEAR,
C13_SBUSA TYPE
 FAGLFLEXT-SBUSA,
C14_SFAREA TYPE
 FAGLFLEXT-SFAREA,
C15_PPRCTR TYPE
 FAGLFLEXT-PPRCTR,
C16_RPMAX TYPE
 FAGLFLEXT-RPMAX,
C17_RACCT TYPE
 FAGLFLEXT-RACCT,
C18_RVERS TYPE
 FAGLFLEXT-RVERS,
C19_RLDNR TYPE
 FAGLFLEXT-RLDNR,
C20_LOGSYS TYPE
 FAGLFLEXT-LOGSYS,
C21_COST_ELEM TYPE
 FAGLFLEXT-COST_ELEM,
C22_RCNTR TYPE
 FAGLFLEXT-RCNTR,
C23_KOKRS TYPE
 FAGLFLEXT-KOKRS,
C24_HSL01 TYPE
 FAGLFLEXT-HSL01,
C25_HSL02 TYPE
 FAGLFLEXT-HSL02,
C26_HSL03 TYPE
 FAGLFLEXT-HSL03,
C27_HSL04 TYPE
 FAGLFLEXT-HSL04,
C28_HSL05 TYPE
 FAGLFLEXT-HSL05,
C29_HSL06 TYPE
 FAGLFLEXT-HSL06,
C30_HSL07 TYPE
 FAGLFLEXT-HSL07,
C31_HSL08 TYPE
 FAGLFLEXT-HSL08,
C32_HSL09 TYPE
 FAGLFLEXT-HSL09,
C33_HSL10 TYPE
 FAGLFLEXT-HSL10,
C34_HSL11 TYPE
 FAGLFLEXT-HSL11,
C35_HSL12 TYPE
 FAGLFLEXT-HSL12,
C36_HSL13 TYPE
 FAGLFLEXT-HSL13,
C37_HSL14 TYPE
 FAGLFLEXT-HSL14,
C38_HSL15 TYPE
 FAGLFLEXT-HSL15,
C39_HSL16 TYPE
 FAGLFLEXT-HSL16,
C40_DRCRK TYPE
 FAGLFLEXT-DRCRK,
C41_HSLVT TYPE
 FAGLFLEXT-HSLVT,
C42_TSLVT TYPE
 FAGLFLEXT-TSLVT,
C43_KSLVT TYPE
 FAGLFLEXT-KSLVT,
C44_RTCUR TYPE
 FAGLFLEXT-RTCUR,
C45_TSL05 TYPE
 FAGLFLEXT-TSL05,
C46_TSL01 TYPE
 FAGLFLEXT-TSL01,
C47_TSL06 TYPE
 FAGLFLEXT-TSL06,
C48_TSL02 TYPE
 FAGLFLEXT-TSL02,
C49_TSL04 TYPE
 FAGLFLEXT-TSL04,
C50_TSL03 TYPE
 FAGLFLEXT-TSL03,
C51_TSL07 TYPE
 FAGLFLEXT-TSL07,
C52_TSL12 TYPE
 FAGLFLEXT-TSL12,
C53_TSL08 TYPE
 FAGLFLEXT-TSL08,
C54_TSL11 TYPE
 FAGLFLEXT-TSL11,
C55_TSL09 TYPE
 FAGLFLEXT-TSL09,
C56_TSL10 TYPE
 FAGLFLEXT-TSL10,
C57_TSL13 TYPE
 FAGLFLEXT-TSL13,
C58_TSL16 TYPE
 FAGLFLEXT-TSL16,
C59_TSL14 TYPE
 FAGLFLEXT-TSL14,
C60_TSL15 TYPE
 FAGLFLEXT-TSL15,
C61_RRCTY TYPE
 FAGLFLEXT-RRCTY,
C62_KSL11 TYPE
 FAGLFLEXT-KSL11,
C63_KSL02 TYPE
 FAGLFLEXT-KSL02,
C64_KSL10 TYPE
 FAGLFLEXT-KSL10,
C65_KSL15 TYPE
 FAGLFLEXT-KSL15,
C66_KSL07 TYPE
 FAGLFLEXT-KSL07,
C67_KSL09 TYPE
 FAGLFLEXT-KSL09,
C68_KSL03 TYPE
 FAGLFLEXT-KSL03,
C69_KSL08 TYPE
 FAGLFLEXT-KSL08,
C70_KSL14 TYPE
 FAGLFLEXT-KSL14,
C71_KSL04 TYPE
 FAGLFLEXT-KSL04,
C72_KSL05 TYPE
 FAGLFLEXT-KSL05,
C73_KSL01 TYPE
 FAGLFLEXT-KSL01,
C74_KSL12 TYPE
 FAGLFLEXT-KSL12,
C75_KSL13 TYPE
 FAGLFLEXT-KSL13,
C76_KSL06 TYPE
 FAGLFLEXT-KSL06,
C77_KSL16 TYPE
 FAGLFLEXT-KSL16,
C78_RCLNT TYPE
 FAGLFLEXT-RCLNT,
C79_MWAER TYPE
 T000-MWAER,
C80_OBJNR00 TYPE
 FAGLFLEXT-OBJNR00,
C81_OBJNR01 TYPE
 FAGLFLEXT-OBJNR01,
C82_OBJNR02 TYPE
 FAGLFLEXT-OBJNR02,
C83_OBJNR03 TYPE
 FAGLFLEXT-OBJNR03,
C84_OBJNR04 TYPE
 FAGLFLEXT-OBJNR04,
C85_OBJNR05 TYPE
 FAGLFLEXT-OBJNR05,
C86_OBJNR06 TYPE
 FAGLFLEXT-OBJNR06,
C87_OBJNR07 TYPE
 FAGLFLEXT-OBJNR07,
C88_OBJNR08 TYPE
 FAGLFLEXT-OBJNR08,
C89_ACTIV TYPE
 FAGLFLEXT-ACTIV,
C90_RMVCT TYPE
 FAGLFLEXT-RMVCT,
C91_RUNIT TYPE
 FAGLFLEXT-RUNIT,
C92_AWTYP TYPE
 FAGLFLEXT-AWTYP,
C93_SCNTR TYPE
 FAGLFLEXT-SCNTR,
C94_PSEGMENT TYPE
 FAGLFLEXT-PSEGMENT,
C95_OSLVT TYPE
 FAGLFLEXT-OSLVT,
C96_OSL01 TYPE
 FAGLFLEXT-OSL01,
C97_OSL02 TYPE
 FAGLFLEXT-OSL02,
C98_OSL03 TYPE
 FAGLFLEXT-OSL03,
C99_OSL04 TYPE
 FAGLFLEXT-OSL04,
C100_OSL05 TYPE
 FAGLFLEXT-OSL05,
C101_OSL06 TYPE
 FAGLFLEXT-OSL06,
C102_OSL07 TYPE
 FAGLFLEXT-OSL07,
C103_OSL08 TYPE
 FAGLFLEXT-OSL08,
C104_OSL09 TYPE
 FAGLFLEXT-OSL09,
C105_OSL10 TYPE
 FAGLFLEXT-OSL10,
C106_OSL11 TYPE
 FAGLFLEXT-OSL11,
C107_OSL12 TYPE
 FAGLFLEXT-OSL12,
C108_OSL13 TYPE
 FAGLFLEXT-OSL13,
C109_OSL14 TYPE
 FAGLFLEXT-OSL14,
C110_OSL15 TYPE
 FAGLFLEXT-OSL15,
C111_OSL16 TYPE
 FAGLFLEXT-OSL16,
C112_MSLVT TYPE
 FAGLFLEXT-MSLVT,
C113_MSL01 TYPE
 FAGLFLEXT-MSL01,
C114_MSL02 TYPE
 FAGLFLEXT-MSL02,
C115_MSL03 TYPE
 FAGLFLEXT-MSL03,
C116_MSL04 TYPE
 FAGLFLEXT-MSL04,
C117_MSL05 TYPE
 FAGLFLEXT-MSL05,
C118_MSL06 TYPE
 FAGLFLEXT-MSL06,
C119_MSL07 TYPE
 FAGLFLEXT-MSL07,
C120_MSL08 TYPE
 FAGLFLEXT-MSL08,
C121_MSL09 TYPE
 FAGLFLEXT-MSL09,
C122_MSL10 TYPE
 FAGLFLEXT-MSL10,
C123_MSL11 TYPE
 FAGLFLEXT-MSL11,
C124_MSL12 TYPE
 FAGLFLEXT-MSL12,
C125_MSL13 TYPE
 FAGLFLEXT-MSL13,
C126_MSL14 TYPE
 FAGLFLEXT-MSL14,
C127_MSL15 TYPE
 FAGLFLEXT-MSL15,
C128_MSL16 TYPE
 FAGLFLEXT-MSL16,
C129_TIMESTAMP TYPE
 FAGLFLEXT-TIMESTAMP,
C130_CURIN TYPE
 T005-CURIN,
C131_CURHA TYPE
 T005-CURHA,
C132_WAERS TYPE
 T005-WAERS,
END OF ty_final_target.
**************************
* TABLE type for T001
**************************
TYPES : BEGIN OF ty_T001,

D1_LAND1 TYPE
 T001-LAND1,
D3_WAERS TYPE
 T001-WAERS,
D5_BUKRS TYPE
 T001-BUKRS,
C1_BUTXT TYPE
 T001-BUTXT,
C2_FIKRS TYPE
 T001-FIKRS,
C4_KTOPL TYPE
 T001-KTOPL,
END OF ty_T001.
**************************
* TABLE type for TCURT
**************************
TYPES : BEGIN OF ty_TCURT,

D4_WAERS TYPE
 TCURT-WAERS,
C5_LTEXT TYPE
 TCURT-LTEXT,
END OF ty_TCURT.
**************************
* TABLE type for FAGLFLEXT
**************************
TYPES : BEGIN OF ty_FAGLFLEXT,

D6_RBUKRS TYPE
 FAGLFLEXT-RBUKRS,
D7_RCLNT TYPE
 FAGLFLEXT-RCLNT,
C7_RBUSA TYPE
 FAGLFLEXT-RBUSA,
C8_RFAREA TYPE
 FAGLFLEXT-RFAREA,
C9_SEGMENT TYPE
 FAGLFLEXT-SEGMENT,
C10_PRCTR TYPE
 FAGLFLEXT-PRCTR,
C11_RASSC TYPE
 FAGLFLEXT-RASSC,
C12_RYEAR TYPE
 FAGLFLEXT-RYEAR,
C13_SBUSA TYPE
 FAGLFLEXT-SBUSA,
C14_SFAREA TYPE
 FAGLFLEXT-SFAREA,
C15_PPRCTR TYPE
 FAGLFLEXT-PPRCTR,
C16_RPMAX TYPE
 FAGLFLEXT-RPMAX,
C17_RACCT TYPE
 FAGLFLEXT-RACCT,
C18_RVERS TYPE
 FAGLFLEXT-RVERS,
C19_RLDNR TYPE
 FAGLFLEXT-RLDNR,
C20_LOGSYS TYPE
 FAGLFLEXT-LOGSYS,
C21_COST_ELEM TYPE
 FAGLFLEXT-COST_ELEM,
C22_RCNTR TYPE
 FAGLFLEXT-RCNTR,
C23_KOKRS TYPE
 FAGLFLEXT-KOKRS,
C24_HSL01 TYPE
 FAGLFLEXT-HSL01,
C25_HSL02 TYPE
 FAGLFLEXT-HSL02,
C26_HSL03 TYPE
 FAGLFLEXT-HSL03,
C27_HSL04 TYPE
 FAGLFLEXT-HSL04,
C28_HSL05 TYPE
 FAGLFLEXT-HSL05,
C29_HSL06 TYPE
 FAGLFLEXT-HSL06,
C30_HSL07 TYPE
 FAGLFLEXT-HSL07,
C31_HSL08 TYPE
 FAGLFLEXT-HSL08,
C32_HSL09 TYPE
 FAGLFLEXT-HSL09,
C33_HSL10 TYPE
 FAGLFLEXT-HSL10,
C34_HSL11 TYPE
 FAGLFLEXT-HSL11,
C35_HSL12 TYPE
 FAGLFLEXT-HSL12,
C36_HSL13 TYPE
 FAGLFLEXT-HSL13,
C37_HSL14 TYPE
 FAGLFLEXT-HSL14,
C38_HSL15 TYPE
 FAGLFLEXT-HSL15,
C39_HSL16 TYPE
 FAGLFLEXT-HSL16,
C40_DRCRK TYPE
 FAGLFLEXT-DRCRK,
C41_HSLVT TYPE
 FAGLFLEXT-HSLVT,
C42_TSLVT TYPE
 FAGLFLEXT-TSLVT,
C43_KSLVT TYPE
 FAGLFLEXT-KSLVT,
C44_RTCUR TYPE
 FAGLFLEXT-RTCUR,
C45_TSL05 TYPE
 FAGLFLEXT-TSL05,
C46_TSL01 TYPE
 FAGLFLEXT-TSL01,
C47_TSL06 TYPE
 FAGLFLEXT-TSL06,
C48_TSL02 TYPE
 FAGLFLEXT-TSL02,
C49_TSL04 TYPE
 FAGLFLEXT-TSL04,
C50_TSL03 TYPE
 FAGLFLEXT-TSL03,
C51_TSL07 TYPE
 FAGLFLEXT-TSL07,
C52_TSL12 TYPE
 FAGLFLEXT-TSL12,
C53_TSL08 TYPE
 FAGLFLEXT-TSL08,
C54_TSL11 TYPE
 FAGLFLEXT-TSL11,
C55_TSL09 TYPE
 FAGLFLEXT-TSL09,
C56_TSL10 TYPE
 FAGLFLEXT-TSL10,
C57_TSL13 TYPE
 FAGLFLEXT-TSL13,
C58_TSL16 TYPE
 FAGLFLEXT-TSL16,
C59_TSL14 TYPE
 FAGLFLEXT-TSL14,
C60_TSL15 TYPE
 FAGLFLEXT-TSL15,
C61_RRCTY TYPE
 FAGLFLEXT-RRCTY,
C62_KSL11 TYPE
 FAGLFLEXT-KSL11,
C63_KSL02 TYPE
 FAGLFLEXT-KSL02,
C64_KSL10 TYPE
 FAGLFLEXT-KSL10,
C65_KSL15 TYPE
 FAGLFLEXT-KSL15,
C66_KSL07 TYPE
 FAGLFLEXT-KSL07,
C67_KSL09 TYPE
 FAGLFLEXT-KSL09,
C68_KSL03 TYPE
 FAGLFLEXT-KSL03,
C69_KSL08 TYPE
 FAGLFLEXT-KSL08,
C70_KSL14 TYPE
 FAGLFLEXT-KSL14,
C71_KSL04 TYPE
 FAGLFLEXT-KSL04,
C72_KSL05 TYPE
 FAGLFLEXT-KSL05,
C73_KSL01 TYPE
 FAGLFLEXT-KSL01,
C74_KSL12 TYPE
 FAGLFLEXT-KSL12,
C75_KSL13 TYPE
 FAGLFLEXT-KSL13,
C76_KSL06 TYPE
 FAGLFLEXT-KSL06,
C77_KSL16 TYPE
 FAGLFLEXT-KSL16,
C80_OBJNR00 TYPE
 FAGLFLEXT-OBJNR00,
C81_OBJNR01 TYPE
 FAGLFLEXT-OBJNR01,
C82_OBJNR02 TYPE
 FAGLFLEXT-OBJNR02,
C83_OBJNR03 TYPE
 FAGLFLEXT-OBJNR03,
C84_OBJNR04 TYPE
 FAGLFLEXT-OBJNR04,
C85_OBJNR05 TYPE
 FAGLFLEXT-OBJNR05,
C86_OBJNR06 TYPE
 FAGLFLEXT-OBJNR06,
C87_OBJNR07 TYPE
 FAGLFLEXT-OBJNR07,
C88_OBJNR08 TYPE
 FAGLFLEXT-OBJNR08,
C89_ACTIV TYPE
 FAGLFLEXT-ACTIV,
C90_RMVCT TYPE
 FAGLFLEXT-RMVCT,
C91_RUNIT TYPE
 FAGLFLEXT-RUNIT,
C92_AWTYP TYPE
 FAGLFLEXT-AWTYP,
C93_SCNTR TYPE
 FAGLFLEXT-SCNTR,
C94_PSEGMENT TYPE
 FAGLFLEXT-PSEGMENT,
C95_OSLVT TYPE
 FAGLFLEXT-OSLVT,
C96_OSL01 TYPE
 FAGLFLEXT-OSL01,
C97_OSL02 TYPE
 FAGLFLEXT-OSL02,
C98_OSL03 TYPE
 FAGLFLEXT-OSL03,
C99_OSL04 TYPE
 FAGLFLEXT-OSL04,
C100_OSL05 TYPE
 FAGLFLEXT-OSL05,
C101_OSL06 TYPE
 FAGLFLEXT-OSL06,
C102_OSL07 TYPE
 FAGLFLEXT-OSL07,
C103_OSL08 TYPE
 FAGLFLEXT-OSL08,
C104_OSL09 TYPE
 FAGLFLEXT-OSL09,
C105_OSL10 TYPE
 FAGLFLEXT-OSL10,
C106_OSL11 TYPE
 FAGLFLEXT-OSL11,
C107_OSL12 TYPE
 FAGLFLEXT-OSL12,
C108_OSL13 TYPE
 FAGLFLEXT-OSL13,
C109_OSL14 TYPE
 FAGLFLEXT-OSL14,
C110_OSL15 TYPE
 FAGLFLEXT-OSL15,
C111_OSL16 TYPE
 FAGLFLEXT-OSL16,
C112_MSLVT TYPE
 FAGLFLEXT-MSLVT,
C113_MSL01 TYPE
 FAGLFLEXT-MSL01,
C114_MSL02 TYPE
 FAGLFLEXT-MSL02,
C115_MSL03 TYPE
 FAGLFLEXT-MSL03,
C116_MSL04 TYPE
 FAGLFLEXT-MSL04,
C117_MSL05 TYPE
 FAGLFLEXT-MSL05,
C118_MSL06 TYPE
 FAGLFLEXT-MSL06,
C119_MSL07 TYPE
 FAGLFLEXT-MSL07,
C120_MSL08 TYPE
 FAGLFLEXT-MSL08,
C121_MSL09 TYPE
 FAGLFLEXT-MSL09,
C122_MSL10 TYPE
 FAGLFLEXT-MSL10,
C123_MSL11 TYPE
 FAGLFLEXT-MSL11,
C124_MSL12 TYPE
 FAGLFLEXT-MSL12,
C125_MSL13 TYPE
 FAGLFLEXT-MSL13,
C126_MSL14 TYPE
 FAGLFLEXT-MSL14,
C127_MSL15 TYPE
 FAGLFLEXT-MSL15,
C128_MSL16 TYPE
 FAGLFLEXT-MSL16,
C129_TIMESTAMP TYPE
 FAGLFLEXT-TIMESTAMP,
END OF ty_FAGLFLEXT.
**************************
* TABLE type for T000
**************************
TYPES : BEGIN OF ty_T000,

D8_MANDT TYPE
 T000-MANDT,
C79_MWAER TYPE
 T000-MWAER,
END OF ty_T000.
**************************
* TABLE type for T005
**************************
TYPES : BEGIN OF ty_T005,

D2_LAND1 TYPE
 T005-LAND1,
C130_CURIN TYPE
 T005-CURIN,
C131_CURHA TYPE
 T005-CURHA,
C132_WAERS TYPE
 T005-WAERS,
END OF ty_T005.
TYPES: BEGIN OF gs_text,
line type string,
END OF gs_text.
************************
*Structure Declarations
************************
DATA: wa_final_tmp type ty_final_tmp.
DATA: wa_final_string TYPE string,
      wa_final TYPE ty_final,
      wa_final_target TYPE ty_final_target,
wa_T001 TYPE ty_T001,
wa_TCURT TYPE ty_TCURT,
wa_FAGLFLEXT TYPE ty_FAGLFLEXT,
wa_T000 TYPE ty_T000,
wa_T005 TYPE ty_T005,
********************
*TABLE Declarations
********************
gt_result TYPE TABLE OF string,
tt_final TYPE STANDARD TABLE OF ty_final,
tt_final_target TYPE STANDARD
TABLE OF ty_final_target,
tt_final_tmp TYPE STANDARD
TABLE OF ty_final_tmp,
tt_final_tmp1 TYPE STANDARD
TABLE OF ty_final,
*Intermediate Output Internal TABLE for join 1
tt_final1 TYPE STANDARD TABLE OF ty_final,
*Intermediate Output Internal TABLE for join 2
tt_final2 TYPE STANDARD TABLE OF ty_final,
*Intermediate Output Internal TABLE for join 3
tt_final3 TYPE STANDARD TABLE OF ty_final,
*Intermediate Output Internal TABLE for join 4
tt_final4 TYPE STANDARD TABLE OF ty_final,
tt_T001 TYPE STANDARD TABLE OF ty_T001,
tt_TCURT TYPE STANDARD TABLE OF ty_TCURT,
tt_FAGLFLEXT TYPE STANDARD TABLE OF ty_FAGLFLEXT,
tt_T000 TYPE STANDARD TABLE OF ty_T000,
tt_T005 TYPE STANDARD TABLE OF ty_T005,
***********************
*Variable Declarations
***********************
lv_flag TYPE char1,
C1_BUTXT
 TYPE STRING,
C2_FIKRS
 TYPE STRING,
C3_WAERS
 TYPE STRING,
C4_KTOPL
 TYPE STRING,
C5_LTEXT
 TYPE STRING,
C6_RBUKRS
 TYPE STRING,
C7_RBUSA
 TYPE STRING,
C8_RFAREA
 TYPE STRING,
C9_SEGMENT
 TYPE STRING,
C10_PRCTR
 TYPE STRING,
C11_RASSC
 TYPE STRING,
C12_RYEAR
 TYPE STRING,
C13_SBUSA
 TYPE STRING,
C14_SFAREA
 TYPE STRING,
C15_PPRCTR
 TYPE STRING,
C16_RPMAX
 TYPE STRING,
C17_RACCT
 TYPE STRING,
C18_RVERS
 TYPE STRING,
C19_RLDNR
 TYPE STRING,
C20_LOGSYS
 TYPE STRING,
C21_COST_ELEM
 TYPE STRING,
C22_RCNTR
 TYPE STRING,
C23_KOKRS
 TYPE STRING,
C24_HSL01
 TYPE STRING,
C25_HSL02
 TYPE STRING,
C26_HSL03
 TYPE STRING,
C27_HSL04
 TYPE STRING,
C28_HSL05
 TYPE STRING,
C29_HSL06
 TYPE STRING,
C30_HSL07
 TYPE STRING,
C31_HSL08
 TYPE STRING,
C32_HSL09
 TYPE STRING,
C33_HSL10
 TYPE STRING,
C34_HSL11
 TYPE STRING,
C35_HSL12
 TYPE STRING,
C36_HSL13
 TYPE STRING,
C37_HSL14
 TYPE STRING,
C38_HSL15
 TYPE STRING,
C39_HSL16
 TYPE STRING,
C40_DRCRK
 TYPE STRING,
C41_HSLVT
 TYPE STRING,
C42_TSLVT
 TYPE STRING,
C43_KSLVT
 TYPE STRING,
C44_RTCUR
 TYPE STRING,
C45_TSL05
 TYPE STRING,
C46_TSL01
 TYPE STRING,
C47_TSL06
 TYPE STRING,
C48_TSL02
 TYPE STRING,
C49_TSL04
 TYPE STRING,
C50_TSL03
 TYPE STRING,
C51_TSL07
 TYPE STRING,
C52_TSL12
 TYPE STRING,
C53_TSL08
 TYPE STRING,
C54_TSL11
 TYPE STRING,
C55_TSL09
 TYPE STRING,
C56_TSL10
 TYPE STRING,
C57_TSL13
 TYPE STRING,
C58_TSL16
 TYPE STRING,
C59_TSL14
 TYPE STRING,
C60_TSL15
 TYPE STRING,
C61_RRCTY
 TYPE STRING,
C62_KSL11
 TYPE STRING,
C63_KSL02
 TYPE STRING,
C64_KSL10
 TYPE STRING,
C65_KSL15
 TYPE STRING,
C66_KSL07
 TYPE STRING,
C67_KSL09
 TYPE STRING,
C68_KSL03
 TYPE STRING,
C69_KSL08
 TYPE STRING,
C70_KSL14
 TYPE STRING,
C71_KSL04
 TYPE STRING,
C72_KSL05
 TYPE STRING,
C73_KSL01
 TYPE STRING,
C74_KSL12
 TYPE STRING,
C75_KSL13
 TYPE STRING,
C76_KSL06
 TYPE STRING,
C77_KSL16
 TYPE STRING,
C78_RCLNT
 TYPE STRING,
C79_MWAER
 TYPE STRING,
C80_OBJNR00
 TYPE STRING,
C81_OBJNR01
 TYPE STRING,
C82_OBJNR02
 TYPE STRING,
C83_OBJNR03
 TYPE STRING,
C84_OBJNR04
 TYPE STRING,
C85_OBJNR05
 TYPE STRING,
C86_OBJNR06
 TYPE STRING,
C87_OBJNR07
 TYPE STRING,
C88_OBJNR08
 TYPE STRING,
C89_ACTIV
 TYPE STRING,
C90_RMVCT
 TYPE STRING,
C91_RUNIT
 TYPE STRING,
C92_AWTYP
 TYPE STRING,
C93_SCNTR
 TYPE STRING,
C94_PSEGMENT
 TYPE STRING,
C95_OSLVT
 TYPE STRING,
C96_OSL01
 TYPE STRING,
C97_OSL02
 TYPE STRING,
C98_OSL03
 TYPE STRING,
C99_OSL04
 TYPE STRING,
C100_OSL05
 TYPE STRING,
C101_OSL06
 TYPE STRING,
C102_OSL07
 TYPE STRING,
C103_OSL08
 TYPE STRING,
C104_OSL09
 TYPE STRING,
C105_OSL10
 TYPE STRING,
C106_OSL11
 TYPE STRING,
C107_OSL12
 TYPE STRING,
C108_OSL13
 TYPE STRING,
C109_OSL14
 TYPE STRING,
C110_OSL15
 TYPE STRING,
C111_OSL16
 TYPE STRING,
C112_MSLVT
 TYPE STRING,
C113_MSL01
 TYPE STRING,
C114_MSL02
 TYPE STRING,
C115_MSL03
 TYPE STRING,
C116_MSL04
 TYPE STRING,
C117_MSL05
 TYPE STRING,
C118_MSL06
 TYPE STRING,
C119_MSL07
 TYPE STRING,
C120_MSL08
 TYPE STRING,
C121_MSL09
 TYPE STRING,
C122_MSL10
 TYPE STRING,
C123_MSL11
 TYPE STRING,
C124_MSL12
 TYPE STRING,
C125_MSL13
 TYPE STRING,
C126_MSL14
 TYPE STRING,
C127_MSL15
 TYPE STRING,
C128_MSL16
 TYPE STRING,
C129_TIMESTAMP
 TYPE STRING,
C130_CURIN
 TYPE STRING,
C131_CURHA
 TYPE STRING,
C132_WAERS
 TYPE STRING,
lv_delimiter type string,
lv_tabix_frm TYPE SY-TABIX,
lv_path TYPE string,
lv_file TYPE string,
lv_datum TYPE sy-datum,
lv_date  TYPE char10,
wa_result TYPE string,
lv_cnt TYPE sytabix.
*********************
*Cursor Declaration
*********************
DATA: lv_T001_dbcur  TYPE cursor.
lv_delimiter = iv_delimiter.
"Hash value was causing problem. it is comment out
*IF  iv_hashvalue NE '-121621257'.
*CLEAR et_file_return.
*et_file_return-type = 'E'.
*et_file_return-message =
*'Installed ABAP program does not match interface definition'.
*APPEND et_file_return.
*EXIT.
*ENDIF.
***********************
*Open/DELETE output file
***********************
CONCATENATE iv_path iv_filename INTO lv_path.
*CHECK for file existence, if found, DELETE it
OPEN DATASET lv_path FOR INPUT
     IN TEXT MODE
     ENCODING DEFAULT.
IF sy-subrc EQ 0.
  DELETE DATASET lv_path.
ENDIF.
*Open/CREATE output file
OPEN DATASET lv_path FOR APPENDING
     IN TEXT MODE
     ENCODING DEFAULT.
IF sy-subrc NE 0.
DATA: lv_mesg TYPE string.
CLEAR et_file_return.
et_file_return-type = 'E'.
CONCATENATE
'Error occurred when creating dataset' lv_path
INTO lv_mesg.
et_file_return-message = lv_mesg.
Append et_file_return.
ENDIF.
*****************
*Batch Processing
*****************
OPEN CURSOR WITH HOLD lv_T001_dbcur FOR
SELECT LAND1
WAERS
BUKRS
BUTXT
FIKRS
KTOPL
FROM  T001.
DO.
*CHECK for the counter, only for first batch
*process new line is required...
lv_cnt  = lv_cnt  + 1.
REFRESH tt_T001.
FETCH NEXT CURSOR lv_T001_dbcur
APPENDING TABLE tt_T001
PACKAGE SIZE IV_FETCH_BATCH_SIZE.
IF NOT tt_T001 IS INITIAL.
************************************
*Read data FROM child TABLE TCURT
************************************
REFRESH tt_TCURT.
SELECT WAERS
LTEXT
FROM   TCURT
INTO TABLE tt_TCURT
FOR ALL ENTRIES IN tt_T001
WHERE WAERS =
tt_T001-D3_WAERS
AND   SPRAS = IV_P_LANGUAGE_CODE.
.
IF NOT tt_TCURT IS INITIAL.
************************************
*Read data FROM child TABLE FAGLFLEXT
************************************
REFRESH tt_FAGLFLEXT.
SELECT RBUKRS
RCLNT
RBUSA
RFAREA
SEGMENT
PRCTR
RASSC
RYEAR
SBUSA
SFAREA
PPRCTR
RPMAX
RACCT
RVERS
RLDNR
LOGSYS
COST_ELEM
RCNTR
KOKRS
HSL01
HSL02
HSL03
HSL04
HSL05
HSL06
HSL07
HSL08
HSL09
HSL10
HSL11
HSL12
HSL13
HSL14
HSL15
HSL16
DRCRK
HSLVT
TSLVT
KSLVT
RTCUR
TSL05
TSL01
TSL06
TSL02
TSL04
TSL03
TSL07
TSL12
TSL08
TSL11
TSL09
TSL10
TSL13
TSL16
TSL14
TSL15
RRCTY
KSL11
KSL02
KSL10
KSL15
KSL07
KSL09
KSL03
KSL08
KSL14
KSL04
KSL05
KSL01
KSL12
KSL13
KSL06
KSL16
OBJNR00
OBJNR01
OBJNR02
OBJNR03
OBJNR04
OBJNR05
OBJNR06
OBJNR07
OBJNR08
ACTIV
RMVCT
RUNIT
AWTYP
SCNTR
PSEGMENT
OSLVT
OSL01
OSL02
OSL03
OSL04
OSL05
OSL06
OSL07
OSL08
OSL09
OSL10
OSL11
OSL12
OSL13
OSL14
OSL15
OSL16
MSLVT
MSL01
MSL02
MSL03
MSL04
MSL05
MSL06
MSL07
MSL08
MSL09
MSL10
MSL11
MSL12
MSL13
MSL14
MSL15
MSL16
TIMESTAMP
FROM   FAGLFLEXT
INTO TABLE tt_FAGLFLEXT
FOR ALL ENTRIES IN tt_T001
WHERE RBUKRS =
tt_T001-D5_BUKRS
AND   RLDNR =  IV_P_LEDGER_CODE
 AND RYEAR = IV_P_YEAR
 AND RRCTY = IV_P_RECORD_TYPE.
.
IF NOT tt_FAGLFLEXT IS INITIAL.
************************************
*Read data FROM child TABLE T000
************************************
REFRESH tt_T000.
SELECT MANDT
MWAER
FROM   T000
INTO TABLE tt_T000
FOR ALL ENTRIES IN tt_FAGLFLEXT
WHERE MANDT =
tt_FAGLFLEXT-D7_RCLNT
.
IF NOT tt_T000 IS INITIAL.
************************************
*Read data FROM child TABLE T005
************************************
REFRESH tt_T005.
SELECT LAND1
CURIN
CURHA
WAERS
FROM   T005
INTO TABLE tt_T005
FOR ALL ENTRIES IN tt_T001
WHERE LAND1 =
tt_T001-D1_LAND1
.
ENDIF.
ENDIF.
ENDIF.
ELSE.
  EXIT.
ENDIF.
****First Order: INNER JOIN
****First & 2nd TABLE
sort tt_T001 by D3_WAERS.
sort tt_TCURT by D4_WAERS.
CLEAR wa_T001.
LOOP AT tt_T001
INTO wa_T001.
CLEAR : wa_TCURT.
READ TABLE tt_TCURT
WITH KEY D4_WAERS =
 wa_T001-D3_WAERS
TRANSPORTING NO FIELDS
BINARY SEARCH.
if sy-subrc = 0.
lv_tabix_frm = sy-tabix.
LOOP AT tt_TCURT
INTO wa_TCURT
FROM lv_tabix_frm.
IF wa_TCURT-D4_WAERS =
 wa_T001-D3_WAERS.
MOVE wa_TCURT-D4_WAERS
 TO wa_final-D4_WAERS.
MOVE wa_TCURT-C5_LTEXT
 TO wa_final-C5_LTEXT.
MOVE wa_T001-D1_LAND1
 TO wa_final-D1_LAND1.
MOVE wa_T001-D3_WAERS
 TO wa_final-D3_WAERS.
MOVE wa_T001-D5_BUKRS
 TO wa_final-D5_BUKRS.
MOVE wa_T001-C1_BUTXT
 TO wa_final-C1_BUTXT.
MOVE wa_T001-C2_FIKRS
 TO wa_final-C2_FIKRS.
MOVE wa_T001-C4_KTOPL
 TO wa_final-C4_KTOPL.
APPEND wa_final
TO tt_final1.
CLEAR : wa_TCURT.
ELSE.
 EXIT.
ENDIF.
ENDLOOP.
ENDIF.
*CLEAR wa_T001.
ENDLOOP.
free : tt_T001, tt_TCURT.
****Join Order 2 : INNER JOIN
sort tt_final1 by D5_BUKRS.
sort tt_FAGLFLEXT by D6_RBUKRS.
CLEAR wa_final.
LOOP AT tt_final1
INTO wa_final.
CLEAR : wa_FAGLFLEXT.
read TABLE tt_FAGLFLEXT
WITH KEY D6_RBUKRS =
 wa_final-D5_BUKRS
TRANSPORTING NO FIELDS
BINARY SEARCH.
if sy-subrc = 0.
lv_tabix_frm = sy-tabix.
LOOP AT tt_FAGLFLEXT
INTO wa_FAGLFLEXT
FROM lv_tabix_frm.
IF wa_FAGLFLEXT-D6_RBUKRS
 = wa_final-D5_BUKRS.
MOVE wa_FAGLFLEXT-D6_RBUKRS
 TO wa_final-D6_RBUKRS.
MOVE wa_FAGLFLEXT-D7_RCLNT
 TO wa_final-D7_RCLNT.
MOVE wa_FAGLFLEXT-C7_RBUSA
 TO wa_final-C7_RBUSA.
MOVE wa_FAGLFLEXT-C8_RFAREA
 TO wa_final-C8_RFAREA.
MOVE wa_FAGLFLEXT-C9_SEGMENT
 TO wa_final-C9_SEGMENT.
MOVE wa_FAGLFLEXT-C10_PRCTR
 TO wa_final-C10_PRCTR.
MOVE wa_FAGLFLEXT-C11_RASSC
 TO wa_final-C11_RASSC.
MOVE wa_FAGLFLEXT-C12_RYEAR
 TO wa_final-C12_RYEAR.
MOVE wa_FAGLFLEXT-C13_SBUSA
 TO wa_final-C13_SBUSA.
MOVE wa_FAGLFLEXT-C14_SFAREA
 TO wa_final-C14_SFAREA.
MOVE wa_FAGLFLEXT-C15_PPRCTR
 TO wa_final-C15_PPRCTR.
MOVE wa_FAGLFLEXT-C16_RPMAX
 TO wa_final-C16_RPMAX.
MOVE wa_FAGLFLEXT-C17_RACCT
 TO wa_final-C17_RACCT.
MOVE wa_FAGLFLEXT-C18_RVERS
 TO wa_final-C18_RVERS.
MOVE wa_FAGLFLEXT-C19_RLDNR
 TO wa_final-C19_RLDNR.
MOVE wa_FAGLFLEXT-C20_LOGSYS
 TO wa_final-C20_LOGSYS.
MOVE wa_FAGLFLEXT-C21_COST_ELEM
 TO wa_final-C21_COST_ELEM.
MOVE wa_FAGLFLEXT-C22_RCNTR
 TO wa_final-C22_RCNTR.
MOVE wa_FAGLFLEXT-C23_KOKRS
 TO wa_final-C23_KOKRS.
MOVE wa_FAGLFLEXT-C24_HSL01
 TO wa_final-C24_HSL01.
MOVE wa_FAGLFLEXT-C25_HSL02
 TO wa_final-C25_HSL02.
MOVE wa_FAGLFLEXT-C26_HSL03
 TO wa_final-C26_HSL03.
MOVE wa_FAGLFLEXT-C27_HSL04
 TO wa_final-C27_HSL04.
MOVE wa_FAGLFLEXT-C28_HSL05
 TO wa_final-C28_HSL05.
MOVE wa_FAGLFLEXT-C29_HSL06
 TO wa_final-C29_HSL06.
MOVE wa_FAGLFLEXT-C30_HSL07
 TO wa_final-C30_HSL07.
MOVE wa_FAGLFLEXT-C31_HSL08
 TO wa_final-C31_HSL08.
MOVE wa_FAGLFLEXT-C32_HSL09
 TO wa_final-C32_HSL09.
MOVE wa_FAGLFLEXT-C33_HSL10
 TO wa_final-C33_HSL10.
MOVE wa_FAGLFLEXT-C34_HSL11
 TO wa_final-C34_HSL11.
MOVE wa_FAGLFLEXT-C35_HSL12
 TO wa_final-C35_HSL12.
MOVE wa_FAGLFLEXT-C36_HSL13
 TO wa_final-C36_HSL13.
MOVE wa_FAGLFLEXT-C37_HSL14
 TO wa_final-C37_HSL14.
MOVE wa_FAGLFLEXT-C38_HSL15
 TO wa_final-C38_HSL15.
MOVE wa_FAGLFLEXT-C39_HSL16
 TO wa_final-C39_HSL16.
MOVE wa_FAGLFLEXT-C40_DRCRK
 TO wa_final-C40_DRCRK.
MOVE wa_FAGLFLEXT-C41_HSLVT
 TO wa_final-C41_HSLVT.
MOVE wa_FAGLFLEXT-C42_TSLVT
 TO wa_final-C42_TSLVT.
MOVE wa_FAGLFLEXT-C43_KSLVT
 TO wa_final-C43_KSLVT.
MOVE wa_FAGLFLEXT-C44_RTCUR
 TO wa_final-C44_RTCUR.
MOVE wa_FAGLFLEXT-C45_TSL05
 TO wa_final-C45_TSL05.
MOVE wa_FAGLFLEXT-C46_TSL01
 TO wa_final-C46_TSL01.
MOVE wa_FAGLFLEXT-C47_TSL06
 TO wa_final-C47_TSL06.
MOVE wa_FAGLFLEXT-C48_TSL02
 TO wa_final-C48_TSL02.
MOVE wa_FAGLFLEXT-C49_TSL04
 TO wa_final-C49_TSL04.
MOVE wa_FAGLFLEXT-C50_TSL03
 TO wa_final-C50_TSL03.
MOVE wa_FAGLFLEXT-C51_TSL07
 TO wa_final-C51_TSL07.
MOVE wa_FAGLFLEXT-C52_TSL12
 TO wa_final-C52_TSL12.
MOVE wa_FAGLFLEXT-C53_TSL08
 TO wa_final-C53_TSL08.
MOVE wa_FAGLFLEXT-C54_TSL11
 TO wa_final-C54_TSL11.
MOVE wa_FAGLFLEXT-C55_TSL09
 TO wa_final-C55_TSL09.
MOVE wa_FAGLFLEXT-C56_TSL10
 TO wa_final-C56_TSL10.
MOVE wa_FAGLFLEXT-C57_TSL13
 TO wa_final-C57_TSL13.
MOVE wa_FAGLFLEXT-C58_TSL16
 TO wa_final-C58_TSL16.
MOVE wa_FAGLFLEXT-C59_TSL14
 TO wa_final-C59_TSL14.
MOVE wa_FAGLFLEXT-C60_TSL15
 TO wa_final-C60_TSL15.
MOVE wa_FAGLFLEXT-C61_RRCTY
 TO wa_final-C61_RRCTY.
MOVE wa_FAGLFLEXT-C62_KSL11
 TO wa_final-C62_KSL11.
MOVE wa_FAGLFLEXT-C63_KSL02
 TO wa_final-C63_KSL02.
MOVE wa_FAGLFLEXT-C64_KSL10
 TO wa_final-C64_KSL10.
MOVE wa_FAGLFLEXT-C65_KSL15
 TO wa_final-C65_KSL15.
MOVE wa_FAGLFLEXT-C66_KSL07
 TO wa_final-C66_KSL07.
MOVE wa_FAGLFLEXT-C67_KSL09
 TO wa_final-C67_KSL09.
MOVE wa_FAGLFLEXT-C68_KSL03
 TO wa_final-C68_KSL03.
MOVE wa_FAGLFLEXT-C69_KSL08
 TO wa_final-C69_KSL08.
MOVE wa_FAGLFLEXT-C70_KSL14
 TO wa_final-C70_KSL14.
MOVE wa_FAGLFLEXT-C71_KSL04
 TO wa_final-C71_KSL04.
MOVE wa_FAGLFLEXT-C72_KSL05
 TO wa_final-C72_KSL05.
MOVE wa_FAGLFLEXT-C73_KSL01
 TO wa_final-C73_KSL01.
MOVE wa_FAGLFLEXT-C74_KSL12
 TO wa_final-C74_KSL12.
MOVE wa_FAGLFLEXT-C75_KSL13
 TO wa_final-C75_KSL13.
MOVE wa_FAGLFLEXT-C76_KSL06
 TO wa_final-C76_KSL06.
MOVE wa_FAGLFLEXT-C77_KSL16
 TO wa_final-C77_KSL16.
MOVE wa_FAGLFLEXT-C80_OBJNR00
 TO wa_final-C80_OBJNR00.
MOVE wa_FAGLFLEXT-C81_OBJNR01
 TO wa_final-C81_OBJNR01.
MOVE wa_FAGLFLEXT-C82_OBJNR02
 TO wa_final-C82_OBJNR02.
MOVE wa_FAGLFLEXT-C83_OBJNR03
 TO wa_final-C83_OBJNR03.
MOVE wa_FAGLFLEXT-C84_OBJNR04
 TO wa_final-C84_OBJNR04.
MOVE wa_FAGLFLEXT-C85_OBJNR05
 TO wa_final-C85_OBJNR05.
MOVE wa_FAGLFLEXT-C86_OBJNR06
 TO wa_final-C86_OBJNR06.
MOVE wa_FAGLFLEXT-C87_OBJNR07
 TO wa_final-C87_OBJNR07.
MOVE wa_FAGLFLEXT-C88_OBJNR08
 TO wa_final-C88_OBJNR08.
MOVE wa_FAGLFLEXT-C89_ACTIV
 TO wa_final-C89_ACTIV.
MOVE wa_FAGLFLEXT-C90_RMVCT
 TO wa_final-C90_RMVCT.
MOVE wa_FAGLFLEXT-C91_RUNIT
 TO wa_final-C91_RUNIT.
MOVE wa_FAGLFLEXT-C92_AWTYP
 TO wa_final-C92_AWTYP.
MOVE wa_FAGLFLEXT-C93_SCNTR
 TO wa_final-C93_SCNTR.
MOVE wa_FAGLFLEXT-C94_PSEGMENT
 TO wa_final-C94_PSEGMENT.
MOVE wa_FAGLFLEXT-C95_OSLVT
 TO wa_final-C95_OSLVT.
MOVE wa_FAGLFLEXT-C96_OSL01
 TO wa_final-C96_OSL01.
MOVE wa_FAGLFLEXT-C97_OSL02
 TO wa_final-C97_OSL02.
MOVE wa_FAGLFLEXT-C98_OSL03
 TO wa_final-C98_OSL03.
MOVE wa_FAGLFLEXT-C99_OSL04
 TO wa_final-C99_OSL04.
MOVE wa_FAGLFLEXT-C100_OSL05
 TO wa_final-C100_OSL05.
MOVE wa_FAGLFLEXT-C101_OSL06
 TO wa_final-C101_OSL06.
MOVE wa_FAGLFLEXT-C102_OSL07
 TO wa_final-C102_OSL07.
MOVE wa_FAGLFLEXT-C103_OSL08
 TO wa_final-C103_OSL08.
MOVE wa_FAGLFLEXT-C104_OSL09
 TO wa_final-C104_OSL09.
MOVE wa_FAGLFLEXT-C105_OSL10
 TO wa_final-C105_OSL10.
MOVE wa_FAGLFLEXT-C106_OSL11
 TO wa_final-C106_OSL11.
MOVE wa_FAGLFLEXT-C107_OSL12
 TO wa_final-C107_OSL12.
MOVE wa_FAGLFLEXT-C108_OSL13
 TO wa_final-C108_OSL13.
MOVE wa_FAGLFLEXT-C109_OSL14
 TO wa_final-C109_OSL14.
MOVE wa_FAGLFLEXT-C110_OSL15
 TO wa_final-C110_OSL15.
MOVE wa_FAGLFLEXT-C111_OSL16
 TO wa_final-C111_OSL16.
MOVE wa_FAGLFLEXT-C112_MSLVT
 TO wa_final-C112_MSLVT.
MOVE wa_FAGLFLEXT-C113_MSL01
 TO wa_final-C113_MSL01.
MOVE wa_FAGLFLEXT-C114_MSL02
 TO wa_final-C114_MSL02.
MOVE wa_FAGLFLEXT-C115_MSL03
 TO wa_final-C115_MSL03.
MOVE wa_FAGLFLEXT-C116_MSL04
 TO wa_final-C116_MSL04.
MOVE wa_FAGLFLEXT-C117_MSL05
 TO wa_final-C117_MSL05.
MOVE wa_FAGLFLEXT-C118_MSL06
 TO wa_final-C118_MSL06.
MOVE wa_FAGLFLEXT-C119_MSL07
 TO wa_final-C119_MSL07.
MOVE wa_FAGLFLEXT-C120_MSL08
 TO wa_final-C120_MSL08.
MOVE wa_FAGLFLEXT-C121_MSL09
 TO wa_final-C121_MSL09.
MOVE wa_FAGLFLEXT-C122_MSL10
 TO wa_final-C122_MSL10.
MOVE wa_FAGLFLEXT-C123_MSL11
 TO wa_final-C123_MSL11.
MOVE wa_FAGLFLEXT-C124_MSL12
 TO wa_final-C124_MSL12.
MOVE wa_FAGLFLEXT-C125_MSL13
 TO wa_final-C125_MSL13.
MOVE wa_FAGLFLEXT-C126_MSL14
 TO wa_final-C126_MSL14.
MOVE wa_FAGLFLEXT-C127_MSL15
 TO wa_final-C127_MSL15.
MOVE wa_FAGLFLEXT-C128_MSL16
 TO wa_final-C128_MSL16.
MOVE wa_FAGLFLEXT-C129_TIMESTAMP
 TO wa_final-C129_TIMESTAMP.
APPEND wa_final
TO tt_final2.
CLEAR : wa_FAGLFLEXT.
ELSE.
 EXIT.
ENDIF.
ENDLOOP.
ENDIF.
ENDLOOP.
free : tt_final1, tt_FAGLFLEXT.
****Join Order 3 : INNER JOIN
sort tt_final2 by D7_RCLNT.
sort tt_T000 by D8_MANDT.
CLEAR wa_final.
LOOP AT tt_final2
INTO wa_final.
CLEAR : wa_T000.
read TABLE tt_T000
WITH KEY D8_MANDT =
 wa_final-D7_RCLNT
TRANSPORTING NO FIELDS
BINARY SEARCH.
if sy-subrc = 0.
lv_tabix_frm = sy-tabix.
LOOP AT tt_T000
INTO wa_T000
FROM lv_tabix_frm.
IF wa_T000-D8_MANDT
 = wa_final-D7_RCLNT.
MOVE wa_T000-D8_MANDT
 TO wa_final-D8_MANDT.
MOVE wa_T000-C79_MWAER
 TO wa_final-C79_MWAER.
APPEND wa_final
TO tt_final3.
CLEAR : wa_T000.
ELSE.
 EXIT.
ENDIF.
ENDLOOP.
ENDIF.
ENDLOOP.
free : tt_final2, tt_T000.
****Join Order 4 : INNER JOIN
sort tt_final3 by D1_LAND1.
sort tt_T005 by D2_LAND1.
CLEAR wa_final.
LOOP AT tt_final3
INTO wa_final.
CLEAR : wa_T005.
read TABLE tt_T005
WITH KEY D2_LAND1 =
 wa_final-D1_LAND1
TRANSPORTING NO FIELDS
BINARY SEARCH.
if sy-subrc = 0.
lv_tabix_frm = sy-tabix.
LOOP AT tt_T005
INTO wa_T005
FROM lv_tabix_frm.
IF wa_T005-D2_LAND1
 = wa_final-D1_LAND1.
MOVE wa_T005-D2_LAND1
 TO wa_final-D2_LAND1.
MOVE wa_T005-C130_CURIN
 TO wa_final-C130_CURIN.
MOVE wa_T005-C131_CURHA
 TO wa_final-C131_CURHA.
MOVE wa_T005-C132_WAERS
 TO wa_final-C132_WAERS.
APPEND wa_final
TO tt_final4.
CLEAR : wa_T005.
ELSE.
 EXIT.
ENDIF.
ENDLOOP.
ENDIF.
ENDLOOP.
free : tt_final3, tt_T005.
***** END OF INNER/LEFT OUTER JOIN *****
LOOP AT tt_final4 INTO wa_final.
MOVE-CORRESPONDING wa_final TO wa_final_tmp.
APPEND wa_final_tmp TO tt_final_tmp.
*CLEAR wa_final.
ENDLOOP.
free : tt_final4.
LOOP AT tt_final_tmp INTO wa_final_tmp.
MOVE wa_final_tmp-C1_BUTXT
 TO wa_final_target-C1_BUTXT.
MOVE wa_final_tmp-C2_FIKRS
 TO wa_final_target-C2_FIKRS.
MOVE wa_final_tmp-D3_WAERS
 TO wa_final_target-C3_WAERS.
MOVE wa_final_tmp-C4_KTOPL
 TO wa_final_target-C4_KTOPL.
MOVE wa_final_tmp-C5_LTEXT
 TO wa_final_target-C5_LTEXT.
MOVE wa_final_tmp-D6_RBUKRS
 TO wa_final_target-C6_RBUKRS.
MOVE wa_final_tmp-C7_RBUSA
 TO wa_final_target-C7_RBUSA.
MOVE wa_final_tmp-C8_RFAREA
 TO wa_final_target-C8_RFAREA.
MOVE wa_final_tmp-C9_SEGMENT
 TO wa_final_target-C9_SEGMENT.
MOVE wa_final_tmp-C10_PRCTR
 TO wa_final_target-C10_PRCTR.
MOVE wa_final_tmp-C11_RASSC
 TO wa_final_target-C11_RASSC.
MOVE wa_final_tmp-C12_RYEAR
 TO wa_final_target-C12_RYEAR.
MOVE wa_final_tmp-C13_SBUSA
 TO wa_final_target-C13_SBUSA.
MOVE wa_final_tmp-C14_SFAREA
 TO wa_final_target-C14_SFAREA.
MOVE wa_final_tmp-C15_PPRCTR
 TO wa_final_target-C15_PPRCTR.
MOVE wa_final_tmp-C16_RPMAX
 TO wa_final_target-C16_RPMAX.
MOVE wa_final_tmp-C17_RACCT
 TO wa_final_target-C17_RACCT.
MOVE wa_final_tmp-C18_RVERS
 TO wa_final_target-C18_RVERS.
MOVE wa_final_tmp-C19_RLDNR
 TO wa_final_target-C19_RLDNR.
MOVE wa_final_tmp-C20_LOGSYS
 TO wa_final_target-C20_LOGSYS.
MOVE wa_final_tmp-C21_COST_ELEM
 TO wa_final_target-C21_COST_ELEM.
MOVE wa_final_tmp-C22_RCNTR
 TO wa_final_target-C22_RCNTR.
MOVE wa_final_tmp-C23_KOKRS
 TO wa_final_target-C23_KOKRS.
MOVE wa_final_tmp-C24_HSL01
 TO wa_final_target-C24_HSL01.
MOVE wa_final_tmp-C25_HSL02
 TO wa_final_target-C25_HSL02.
MOVE wa_final_tmp-C26_HSL03
 TO wa_final_target-C26_HSL03.
MOVE wa_final_tmp-C27_HSL04
 TO wa_final_target-C27_HSL04.
MOVE wa_final_tmp-C28_HSL05
 TO wa_final_target-C28_HSL05.
MOVE wa_final_tmp-C29_HSL06
 TO wa_final_target-C29_HSL06.
MOVE wa_final_tmp-C30_HSL07
 TO wa_final_target-C30_HSL07.
MOVE wa_final_tmp-C31_HSL08
 TO wa_final_target-C31_HSL08.
MOVE wa_final_tmp-C32_HSL09
 TO wa_final_target-C32_HSL09.
MOVE wa_final_tmp-C33_HSL10
 TO wa_final_target-C33_HSL10.
MOVE wa_final_tmp-C34_HSL11
 TO wa_final_target-C34_HSL11.
MOVE wa_final_tmp-C35_HSL12
 TO wa_final_target-C35_HSL12.
MOVE wa_final_tmp-C36_HSL13
 TO wa_final_target-C36_HSL13.
MOVE wa_final_tmp-C37_HSL14
 TO wa_final_target-C37_HSL14.
MOVE wa_final_tmp-C38_HSL15
 TO wa_final_target-C38_HSL15.
MOVE wa_final_tmp-C39_HSL16
 TO wa_final_target-C39_HSL16.
MOVE wa_final_tmp-C40_DRCRK
 TO wa_final_target-C40_DRCRK.
MOVE wa_final_tmp-C41_HSLVT
 TO wa_final_target-C41_HSLVT.
MOVE wa_final_tmp-C42_TSLVT
 TO wa_final_target-C42_TSLVT.
MOVE wa_final_tmp-C43_KSLVT
 TO wa_final_target-C43_KSLVT.
MOVE wa_final_tmp-C44_RTCUR
 TO wa_final_target-C44_RTCUR.
MOVE wa_final_tmp-C45_TSL05
 TO wa_final_target-C45_TSL05.
MOVE wa_final_tmp-C46_TSL01
 TO wa_final_target-C46_TSL01.
MOVE wa_final_tmp-C47_TSL06
 TO wa_final_target-C47_TSL06.
MOVE wa_final_tmp-C48_TSL02
 TO wa_final_target-C48_TSL02.
MOVE wa_final_tmp-C49_TSL04
 TO wa_final_target-C49_TSL04.
MOVE wa_final_tmp-C50_TSL03
 TO wa_final_target-C50_TSL03.
MOVE wa_final_tmp-C51_TSL07
 TO wa_final_target-C51_TSL07.
MOVE wa_final_tmp-C52_TSL12
 TO wa_final_target-C52_TSL12.
MOVE wa_final_tmp-C53_TSL08
 TO wa_final_target-C53_TSL08.
MOVE wa_final_tmp-C54_TSL11
 TO wa_final_target-C54_TSL11.
MOVE wa_final_tmp-C55_TSL09
 TO wa_final_target-C55_TSL09.
MOVE wa_final_tmp-C56_TSL10
 TO wa_final_target-C56_TSL10.
MOVE wa_final_tmp-C57_TSL13
 TO wa_final_target-C57_TSL13.
MOVE wa_final_tmp-C58_TSL16
 TO wa_final_target-C58_TSL16.
MOVE wa_final_tmp-C59_TSL14
 TO wa_final_target-C59_TSL14.
MOVE wa_final_tmp-C60_TSL15
 TO wa_final_target-C60_TSL15.
MOVE wa_final_tmp-C61_RRCTY
 TO wa_final_target-C61_RRCTY.
MOVE wa_final_tmp-C62_KSL11
 TO wa_final_target-C62_KSL11.
MOVE wa_final_tmp-C63_KSL02
 TO wa_final_target-C63_KSL02.
MOVE wa_final_tmp-C64_KSL10
 TO wa_final_target-C64_KSL10.
MOVE wa_final_tmp-C65_KSL15
 TO wa_final_target-C65_KSL15.
MOVE wa_final_tmp-C66_KSL07
 TO wa_final_target-C66_KSL07.
MOVE wa_final_tmp-C67_KSL09
 TO wa_final_target-C67_KSL09.
MOVE wa_final_tmp-C68_KSL03
 TO wa_final_target-C68_KSL03.
MOVE wa_final_tmp-C69_KSL08
 TO wa_final_target-C69_KSL08.
MOVE wa_final_tmp-C70_KSL14
 TO wa_final_target-C70_KSL14.
MOVE wa_final_tmp-C71_KSL04
 TO wa_final_target-C71_KSL04.
MOVE wa_final_tmp-C72_KSL05
 TO wa_final_target-C72_KSL05.
MOVE wa_final_tmp-C73_KSL01
 TO wa_final_target-C73_KSL01.
MOVE wa_final_tmp-C74_KSL12
 TO wa_final_target-C74_KSL12.
MOVE wa_final_tmp-C75_KSL13
 TO wa_final_target-C75_KSL13.
MOVE wa_final_tmp-C76_KSL06
 TO wa_final_target-C76_KSL06.
MOVE wa_final_tmp-C77_KSL16
 TO wa_final_target-C77_KSL16.
MOVE wa_final_tmp-D7_RCLNT
 TO wa_final_target-C78_RCLNT.
MOVE wa_final_tmp-C79_MWAER
 TO wa_final_target-C79_MWAER.
MOVE wa_final_tmp-C80_OBJNR00
 TO wa_final_target-C80_OBJNR00.
MOVE wa_final_tmp-C81_OBJNR01
 TO wa_final_target-C81_OBJNR01.
MOVE wa_final_tmp-C82_OBJNR02
 TO wa_final_target-C82_OBJNR02.
MOVE wa_final_tmp-C83_OBJNR03
 TO wa_final_target-C83_OBJNR03.
MOVE wa_final_tmp-C84_OBJNR04
 TO wa_final_target-C84_OBJNR04.
MOVE wa_final_tmp-C85_OBJNR05
 TO wa_final_target-C85_OBJNR05.
MOVE wa_final_tmp-C86_OBJNR06
 TO wa_final_target-C86_OBJNR06.
MOVE wa_final_tmp-C87_OBJNR07
 TO wa_final_target-C87_OBJNR07.
MOVE wa_final_tmp-C88_OBJNR08
 TO wa_final_target-C88_OBJNR08.
MOVE wa_final_tmp-C89_ACTIV
 TO wa_final_target-C89_ACTIV.
MOVE wa_final_tmp-C90_RMVCT
 TO wa_final_target-C90_RMVCT.
MOVE wa_final_tmp-C91_RUNIT
 TO wa_final_target-C91_RUNIT.
MOVE wa_final_tmp-C92_AWTYP
 TO wa_final_target-C92_AWTYP.
MOVE wa_final_tmp-C93_SCNTR
 TO wa_final_target-C93_SCNTR.
MOVE wa_final_tmp-C94_PSEGMENT
 TO wa_final_target-C94_PSEGMENT.
MOVE wa_final_tmp-C95_OSLVT
 TO wa_final_target-C95_OSLVT.
MOVE wa_final_tmp-C96_OSL01
 TO wa_final_target-C96_OSL01.
MOVE wa_final_tmp-C97_OSL02
 TO wa_final_target-C97_OSL02.
MOVE wa_final_tmp-C98_OSL03
 TO wa_final_target-C98_OSL03.
MOVE wa_final_tmp-C99_OSL04
 TO wa_final_target-C99_OSL04.
MOVE wa_final_tmp-C100_OSL05
 TO wa_final_target-C100_OSL05.
MOVE wa_final_tmp-C101_OSL06
 TO wa_final_target-C101_OSL06.
MOVE wa_final_tmp-C102_OSL07
 TO wa_final_target-C102_OSL07.
MOVE wa_final_tmp-C103_OSL08
 TO wa_final_target-C103_OSL08.
MOVE wa_final_tmp-C104_OSL09
 TO wa_final_target-C104_OSL09.
MOVE wa_final_tmp-C105_OSL10
 TO wa_final_target-C105_OSL10.
MOVE wa_final_tmp-C106_OSL11
 TO wa_final_target-C106_OSL11.
MOVE wa_final_tmp-C107_OSL12
 TO wa_final_target-C107_OSL12.
MOVE wa_final_tmp-C108_OSL13
 TO wa_final_target-C108_OSL13.
MOVE wa_final_tmp-C109_OSL14
 TO wa_final_target-C109_OSL14.
MOVE wa_final_tmp-C110_OSL15
 TO wa_final_target-C110_OSL15.
MOVE wa_final_tmp-C111_OSL16
 TO wa_final_target-C111_OSL16.
MOVE wa_final_tmp-C112_MSLVT
 TO wa_final_target-C112_MSLVT.
MOVE wa_final_tmp-C113_MSL01
 TO wa_final_target-C113_MSL01.
MOVE wa_final_tmp-C114_MSL02
 TO wa_final_target-C114_MSL02.
MOVE wa_final_tmp-C115_MSL03
 TO wa_final_target-C115_MSL03.
MOVE wa_final_tmp-C116_MSL04
 TO wa_final_target-C116_MSL04.
MOVE wa_final_tmp-C117_MSL05
 TO wa_final_target-C117_MSL05.
MOVE wa_final_tmp-C118_MSL06
 TO wa_final_target-C118_MSL06.
MOVE wa_final_tmp-C119_MSL07
 TO wa_final_target-C119_MSL07.
MOVE wa_final_tmp-C120_MSL08
 TO wa_final_target-C120_MSL08.
MOVE wa_final_tmp-C121_MSL09
 TO wa_final_target-C121_MSL09.
MOVE wa_final_tmp-C122_MSL10
 TO wa_final_target-C122_MSL10.
MOVE wa_final_tmp-C123_MSL11
 TO wa_final_target-C123_MSL11.
MOVE wa_final_tmp-C124_MSL12
 TO wa_final_target-C124_MSL12.
MOVE wa_final_tmp-C125_MSL13
 TO wa_final_target-C125_MSL13.
MOVE wa_final_tmp-C126_MSL14
 TO wa_final_target-C126_MSL14.
MOVE wa_final_tmp-C127_MSL15
 TO wa_final_target-C127_MSL15.
MOVE wa_final_tmp-C128_MSL16
 TO wa_final_target-C128_MSL16.
MOVE wa_final_tmp-C129_TIMESTAMP
 TO wa_final_target-C129_TIMESTAMP.
MOVE wa_final_tmp-C130_CURIN
 TO wa_final_target-C130_CURIN.
MOVE wa_final_tmp-C131_CURHA
 TO wa_final_target-C131_CURHA.
MOVE wa_final_tmp-C132_WAERS
 TO wa_final_target-C132_WAERS.
Append wa_final_target to tt_final_target.
ENDLOOP.
free : tt_final_tmp.
Clear wa_final_target.
IF iv_max_row_cnt IS INITIAL.
 MOVE 2147483647 to iv_max_row_cnt.
ENDIF.
Loop at tt_final_target INTO
wa_final_target TO iv_max_row_cnt.
MOVE wa_final_target-C1_BUTXT
 TO C1_BUTXT.
MOVE wa_final_target-C2_FIKRS
 TO C2_FIKRS.
MOVE wa_final_target-C3_WAERS
 TO C3_WAERS.
MOVE wa_final_target-C4_KTOPL
 TO C4_KTOPL.
MOVE wa_final_target-C5_LTEXT
 TO C5_LTEXT.
MOVE wa_final_target-C6_RBUKRS
 TO C6_RBUKRS.
MOVE wa_final_target-C7_RBUSA
 TO C7_RBUSA.
MOVE wa_final_target-C8_RFAREA
 TO C8_RFAREA.
MOVE wa_final_target-C9_SEGMENT
 TO C9_SEGMENT.
MOVE wa_final_target-C10_PRCTR
 TO C10_PRCTR.
MOVE wa_final_target-C11_RASSC
 TO C11_RASSC.
MOVE wa_final_target-C12_RYEAR
 TO C12_RYEAR.
MOVE wa_final_target-C13_SBUSA
 TO C13_SBUSA.
MOVE wa_final_target-C14_SFAREA
 TO C14_SFAREA.
MOVE wa_final_target-C15_PPRCTR
 TO C15_PPRCTR.
MOVE wa_final_target-C16_RPMAX
 TO C16_RPMAX.
MOVE wa_final_target-C17_RACCT
 TO C17_RACCT.
MOVE wa_final_target-C18_RVERS
 TO C18_RVERS.
MOVE wa_final_target-C19_RLDNR
 TO C19_RLDNR.
MOVE wa_final_target-C20_LOGSYS
 TO C20_LOGSYS.
MOVE wa_final_target-C21_COST_ELEM
 TO C21_COST_ELEM.
MOVE wa_final_target-C22_RCNTR
 TO C22_RCNTR.
MOVE wa_final_target-C23_KOKRS
 TO C23_KOKRS.
MOVE wa_final_target-C24_HSL01
 TO C24_HSL01.
MOVE wa_final_target-C25_HSL02
 TO C25_HSL02.
MOVE wa_final_target-C26_HSL03
 TO C26_HSL03.
MOVE wa_final_target-C27_HSL04
 TO C27_HSL04.
MOVE wa_final_target-C28_HSL05
 TO C28_HSL05.
MOVE wa_final_target-C29_HSL06
 TO C29_HSL06.
MOVE wa_final_target-C30_HSL07
 TO C30_HSL07.
MOVE wa_final_target-C31_HSL08
 TO C31_HSL08.
MOVE wa_final_target-C32_HSL09
 TO C32_HSL09.
MOVE wa_final_target-C33_HSL10
 TO C33_HSL10.
MOVE wa_final_target-C34_HSL11
 TO C34_HSL11.
MOVE wa_final_target-C35_HSL12
 TO C35_HSL12.
MOVE wa_final_target-C36_HSL13
 TO C36_HSL13.
MOVE wa_final_target-C37_HSL14
 TO C37_HSL14.
MOVE wa_final_target-C38_HSL15
 TO C38_HSL15.
MOVE wa_final_target-C39_HSL16
 TO C39_HSL16.
MOVE wa_final_target-C40_DRCRK
 TO C40_DRCRK.
MOVE wa_final_target-C41_HSLVT
 TO C41_HSLVT.
MOVE wa_final_target-C42_TSLVT
 TO C42_TSLVT.
MOVE wa_final_target-C43_KSLVT
 TO C43_KSLVT.
MOVE wa_final_target-C44_RTCUR
 TO C44_RTCUR.
MOVE wa_final_target-C45_TSL05
 TO C45_TSL05.
MOVE wa_final_target-C46_TSL01
 TO C46_TSL01.
MOVE wa_final_target-C47_TSL06
 TO C47_TSL06.
MOVE wa_final_target-C48_TSL02
 TO C48_TSL02.
MOVE wa_final_target-C49_TSL04
 TO C49_TSL04.
MOVE wa_final_target-C50_TSL03
 TO C50_TSL03.
MOVE wa_final_target-C51_TSL07
 TO C51_TSL07.
MOVE wa_final_target-C52_TSL12
 TO C52_TSL12.
MOVE wa_final_target-C53_TSL08
 TO C53_TSL08.
MOVE wa_final_target-C54_TSL11
 TO C54_TSL11.
MOVE wa_final_target-C55_TSL09
 TO C55_TSL09.
MOVE wa_final_target-C56_TSL10
 TO C56_TSL10.
MOVE wa_final_target-C57_TSL13
 TO C57_TSL13.
MOVE wa_final_target-C58_TSL16
 TO C58_TSL16.
MOVE wa_final_target-C59_TSL14
 TO C59_TSL14.
MOVE wa_final_target-C60_TSL15
 TO C60_TSL15.
MOVE wa_final_target-C61_RRCTY
 TO C61_RRCTY.
MOVE wa_final_target-C62_KSL11
 TO C62_KSL11.
MOVE wa_final_target-C63_KSL02
 TO C63_KSL02.
MOVE wa_final_target-C64_KSL10
 TO C64_KSL10.
MOVE wa_final_target-C65_KSL15
 TO C65_KSL15.
MOVE wa_final_target-C66_KSL07
 TO C66_KSL07.
MOVE wa_final_target-C67_KSL09
 TO C67_KSL09.
MOVE wa_final_target-C68_KSL03
 TO C68_KSL03.
MOVE wa_final_target-C69_KSL08
 TO C69_KSL08.
MOVE wa_final_target-C70_KSL14
 TO C70_KSL14.
MOVE wa_final_target-C71_KSL04
 TO C71_KSL04.
MOVE wa_final_target-C72_KSL05
 TO C72_KSL05.
MOVE wa_final_target-C73_KSL01
 TO C73_KSL01.
MOVE wa_final_target-C74_KSL12
 TO C74_KSL12.
MOVE wa_final_target-C75_KSL13
 TO C75_KSL13.
MOVE wa_final_target-C76_KSL06
 TO C76_KSL06.
MOVE wa_final_target-C77_KSL16
 TO C77_KSL16.
MOVE wa_final_target-C78_RCLNT
 TO C78_RCLNT.
MOVE wa_final_target-C79_MWAER
 TO C79_MWAER.
MOVE wa_final_target-C80_OBJNR00
 TO C80_OBJNR00.
MOVE wa_final_target-C81_OBJNR01
 TO C81_OBJNR01.
MOVE wa_final_target-C82_OBJNR02
 TO C82_OBJNR02.
MOVE wa_final_target-C83_OBJNR03
 TO C83_OBJNR03.
MOVE wa_final_target-C84_OBJNR04
 TO C84_OBJNR04.
MOVE wa_final_target-C85_OBJNR05
 TO C85_OBJNR05.
MOVE wa_final_target-C86_OBJNR06
 TO C86_OBJNR06.
MOVE wa_final_target-C87_OBJNR07
 TO C87_OBJNR07.
MOVE wa_final_target-C88_OBJNR08
 TO C88_OBJNR08.
MOVE wa_final_target-C89_ACTIV
 TO C89_ACTIV.
MOVE wa_final_target-C90_RMVCT
 TO C90_RMVCT.
MOVE wa_final_target-C91_RUNIT
 TO C91_RUNIT.
MOVE wa_final_target-C92_AWTYP
 TO C92_AWTYP.
MOVE wa_final_target-C93_SCNTR
 TO C93_SCNTR.
MOVE wa_final_target-C94_PSEGMENT
 TO C94_PSEGMENT.
MOVE wa_final_target-C95_OSLVT
 TO C95_OSLVT.
MOVE wa_final_target-C96_OSL01
 TO C96_OSL01.
MOVE wa_final_target-C97_OSL02
 TO C97_OSL02.
MOVE wa_final_target-C98_OSL03
 TO C98_OSL03.
MOVE wa_final_target-C99_OSL04
 TO C99_OSL04.
MOVE wa_final_target-C100_OSL05
 TO C100_OSL05.
MOVE wa_final_target-C101_OSL06
 TO C101_OSL06.
MOVE wa_final_target-C102_OSL07
 TO C102_OSL07.
MOVE wa_final_target-C103_OSL08
 TO C103_OSL08.
MOVE wa_final_target-C104_OSL09
 TO C104_OSL09.
MOVE wa_final_target-C105_OSL10
 TO C105_OSL10.
MOVE wa_final_target-C106_OSL11
 TO C106_OSL11.
MOVE wa_final_target-C107_OSL12
 TO C107_OSL12.
MOVE wa_final_target-C108_OSL13
 TO C108_OSL13.
MOVE wa_final_target-C109_OSL14
 TO C109_OSL14.
MOVE wa_final_target-C110_OSL15
 TO C110_OSL15.
MOVE wa_final_target-C111_OSL16
 TO C111_OSL16.
MOVE wa_final_target-C112_MSLVT
 TO C112_MSLVT.
MOVE wa_final_target-C113_MSL01
 TO C113_MSL01.
MOVE wa_final_target-C114_MSL02
 TO C114_MSL02.
MOVE wa_final_target-C115_MSL03
 TO C115_MSL03.
MOVE wa_final_target-C116_MSL04
 TO C116_MSL04.
MOVE wa_final_target-C117_MSL05
 TO C117_MSL05.
MOVE wa_final_target-C118_MSL06
 TO C118_MSL06.
MOVE wa_final_target-C119_MSL07
 TO C119_MSL07.
MOVE wa_final_target-C120_MSL08
 TO C120_MSL08.
MOVE wa_final_target-C121_MSL09
 TO C121_MSL09.
MOVE wa_final_target-C122_MSL10
 TO C122_MSL10.
MOVE wa_final_target-C123_MSL11
 TO C123_MSL11.
MOVE wa_final_target-C124_MSL12
 TO C124_MSL12.
MOVE wa_final_target-C125_MSL13
 TO C125_MSL13.
MOVE wa_final_target-C126_MSL14
 TO C126_MSL14.
MOVE wa_final_target-C127_MSL15
 TO C127_MSL15.
MOVE wa_final_target-C128_MSL16
 TO C128_MSL16.
MOVE wa_final_target-C129_TIMESTAMP
 TO C129_TIMESTAMP.
MOVE wa_final_target-C130_CURIN
 TO C130_CURIN.
MOVE wa_final_target-C131_CURHA
 TO C131_CURHA.
MOVE wa_final_target-C132_WAERS
 TO C132_WAERS.
SHIFT C24_HSL01 UP TO '-' LEFT CIRCULAR.
SHIFT C25_HSL02 UP TO '-' LEFT CIRCULAR.
SHIFT C26_HSL03 UP TO '-' LEFT CIRCULAR.
SHIFT C27_HSL04 UP TO '-' LEFT CIRCULAR.
SHIFT C28_HSL05 UP TO '-' LEFT CIRCULAR.
SHIFT C29_HSL06 UP TO '-' LEFT CIRCULAR.
SHIFT C30_HSL07 UP TO '-' LEFT CIRCULAR.
SHIFT C31_HSL08 UP TO '-' LEFT CIRCULAR.
SHIFT C32_HSL09 UP TO '-' LEFT CIRCULAR.
SHIFT C33_HSL10 UP TO '-' LEFT CIRCULAR.
SHIFT C34_HSL11 UP TO '-' LEFT CIRCULAR.
SHIFT C35_HSL12 UP TO '-' LEFT CIRCULAR.
SHIFT C36_HSL13 UP TO '-' LEFT CIRCULAR.
SHIFT C37_HSL14 UP TO '-' LEFT CIRCULAR.
SHIFT C38_HSL15 UP TO '-' LEFT CIRCULAR.
SHIFT C39_HSL16 UP TO '-' LEFT CIRCULAR.
SHIFT C41_HSLVT UP TO '-' LEFT CIRCULAR.
SHIFT C42_TSLVT UP TO '-' LEFT CIRCULAR.
SHIFT C43_KSLVT UP TO '-' LEFT CIRCULAR.
SHIFT C45_TSL05 UP TO '-' LEFT CIRCULAR.
SHIFT C46_TSL01 UP TO '-' LEFT CIRCULAR.
SHIFT C47_TSL06 UP TO '-' LEFT CIRCULAR.
SHIFT C48_TSL02 UP TO '-' LEFT CIRCULAR.
SHIFT C49_TSL04 UP TO '-' LEFT CIRCULAR.
SHIFT C50_TSL03 UP TO '-' LEFT CIRCULAR.
SHIFT C51_TSL07 UP TO '-' LEFT CIRCULAR.
SHIFT C52_TSL12 UP TO '-' LEFT CIRCULAR.
SHIFT C53_TSL08 UP TO '-' LEFT CIRCULAR.
SHIFT C54_TSL11 UP TO '-' LEFT CIRCULAR.
SHIFT C55_TSL09 UP TO '-' LEFT CIRCULAR.
SHIFT C56_TSL10 UP TO '-' LEFT CIRCULAR.
SHIFT C57_TSL13 UP TO '-' LEFT CIRCULAR.
SHIFT C58_TSL16 UP TO '-' LEFT CIRCULAR.
SHIFT C59_TSL14 UP TO '-' LEFT CIRCULAR.
SHIFT C60_TSL15 UP TO '-' LEFT CIRCULAR.
SHIFT C62_KSL11 UP TO '-' LEFT CIRCULAR.
SHIFT C63_KSL02 UP TO '-' LEFT CIRCULAR.
SHIFT C64_KSL10 UP TO '-' LEFT CIRCULAR.
SHIFT C65_KSL15 UP TO '-' LEFT CIRCULAR.
SHIFT C66_KSL07 UP TO '-' LEFT CIRCULAR.
SHIFT C67_KSL09 UP TO '-' LEFT CIRCULAR.
SHIFT C68_KSL03 UP TO '-' LEFT CIRCULAR.
SHIFT C69_KSL08 UP TO '-' LEFT CIRCULAR.
SHIFT C70_KSL14 UP TO '-' LEFT CIRCULAR.
SHIFT C71_KSL04 UP TO '-' LEFT CIRCULAR.
SHIFT C72_KSL05 UP TO '-' LEFT CIRCULAR.
SHIFT C73_KSL01 UP TO '-' LEFT CIRCULAR.
SHIFT C74_KSL12 UP TO '-' LEFT CIRCULAR.
SHIFT C75_KSL13 UP TO '-' LEFT CIRCULAR.
SHIFT C76_KSL06 UP TO '-' LEFT CIRCULAR.
SHIFT C77_KSL16 UP TO '-' LEFT CIRCULAR.
SHIFT C80_OBJNR00 UP TO '-' LEFT CIRCULAR.
SHIFT C81_OBJNR01 UP TO '-' LEFT CIRCULAR.
SHIFT C82_OBJNR02 UP TO '-' LEFT CIRCULAR.
SHIFT C83_OBJNR03 UP TO '-' LEFT CIRCULAR.
SHIFT C84_OBJNR04 UP TO '-' LEFT CIRCULAR.
SHIFT C85_OBJNR05 UP TO '-' LEFT CIRCULAR.
SHIFT C86_OBJNR06 UP TO '-' LEFT CIRCULAR.
SHIFT C87_OBJNR07 UP TO '-' LEFT CIRCULAR.
SHIFT C88_OBJNR08 UP TO '-' LEFT CIRCULAR.
SHIFT C95_OSLVT UP TO '-' LEFT CIRCULAR.
SHIFT C96_OSL01 UP TO '-' LEFT CIRCULAR.
SHIFT C97_OSL02 UP TO '-' LEFT CIRCULAR.
SHIFT C98_OSL03 UP TO '-' LEFT CIRCULAR.
SHIFT C99_OSL04 UP TO '-' LEFT CIRCULAR.
SHIFT C100_OSL05 UP TO '-' LEFT CIRCULAR.
SHIFT C101_OSL06 UP TO '-' LEFT CIRCULAR.
SHIFT C102_OSL07 UP TO '-' LEFT CIRCULAR.
SHIFT C103_OSL08 UP TO '-' LEFT CIRCULAR.
SHIFT C104_OSL09 UP TO '-' LEFT CIRCULAR.
SHIFT C105_OSL10 UP TO '-' LEFT CIRCULAR.
SHIFT C106_OSL11 UP TO '-' LEFT CIRCULAR.
SHIFT C107_OSL12 UP TO '-' LEFT CIRCULAR.
SHIFT C108_OSL13 UP TO '-' LEFT CIRCULAR.
SHIFT C109_OSL14 UP TO '-' LEFT CIRCULAR.
SHIFT C110_OSL15 UP TO '-' LEFT CIRCULAR.
SHIFT C111_OSL16 UP TO '-' LEFT CIRCULAR.
SHIFT C112_MSLVT UP TO '-' LEFT CIRCULAR.
SHIFT C113_MSL01 UP TO '-' LEFT CIRCULAR.
SHIFT C114_MSL02 UP TO '-' LEFT CIRCULAR.
SHIFT C115_MSL03 UP TO '-' LEFT CIRCULAR.
SHIFT C116_MSL04 UP TO '-' LEFT CIRCULAR.
SHIFT C117_MSL05 UP TO '-' LEFT CIRCULAR.
SHIFT C118_MSL06 UP TO '-' LEFT CIRCULAR.
SHIFT C119_MSL07 UP TO '-' LEFT CIRCULAR.
SHIFT C120_MSL08 UP TO '-' LEFT CIRCULAR.
SHIFT C121_MSL09 UP TO '-' LEFT CIRCULAR.
SHIFT C122_MSL10 UP TO '-' LEFT CIRCULAR.
SHIFT C123_MSL11 UP TO '-' LEFT CIRCULAR.
SHIFT C124_MSL12 UP TO '-' LEFT CIRCULAR.
SHIFT C125_MSL13 UP TO '-' LEFT CIRCULAR.
SHIFT C126_MSL14 UP TO '-' LEFT CIRCULAR.
SHIFT C127_MSL15 UP TO '-' LEFT CIRCULAR.
SHIFT C128_MSL16 UP TO '-' LEFT CIRCULAR.
SHIFT C129_TIMESTAMP UP TO '-' LEFT CIRCULAR.
CONCATENATE
C1_BUTXT
C2_FIKRS
C3_WAERS
C4_KTOPL
C5_LTEXT
C6_RBUKRS
C7_RBUSA
C8_RFAREA
C9_SEGMENT
C10_PRCTR
C11_RASSC
C12_RYEAR
C13_SBUSA
C14_SFAREA
C15_PPRCTR
C16_RPMAX
C17_RACCT
C18_RVERS
C19_RLDNR
C20_LOGSYS
C21_COST_ELEM
C22_RCNTR
C23_KOKRS
C24_HSL01
C25_HSL02
C26_HSL03
C27_HSL04
C28_HSL05
C29_HSL06
C30_HSL07
C31_HSL08
C32_HSL09
C33_HSL10
C34_HSL11
C35_HSL12
C36_HSL13
C37_HSL14
C38_HSL15
C39_HSL16
C40_DRCRK
C41_HSLVT
C42_TSLVT
C43_KSLVT
C44_RTCUR
C45_TSL05
C46_TSL01
C47_TSL06
C48_TSL02
C49_TSL04
C50_TSL03
C51_TSL07
C52_TSL12
C53_TSL08
C54_TSL11
C55_TSL09
C56_TSL10
C57_TSL13
C58_TSL16
C59_TSL14
C60_TSL15
C61_RRCTY
C62_KSL11
C63_KSL02
C64_KSL10
C65_KSL15
C66_KSL07
C67_KSL09
C68_KSL03
C69_KSL08
C70_KSL14
C71_KSL04
C72_KSL05
C73_KSL01
C74_KSL12
C75_KSL13
C76_KSL06
C77_KSL16
C78_RCLNT
C79_MWAER
C80_OBJNR00
C81_OBJNR01
C82_OBJNR02
C83_OBJNR03
C84_OBJNR04
C85_OBJNR05
C86_OBJNR06
C87_OBJNR07
C88_OBJNR08
C89_ACTIV
C90_RMVCT
C91_RUNIT
C92_AWTYP
C93_SCNTR
C94_PSEGMENT
C95_OSLVT
C96_OSL01
C97_OSL02
C98_OSL03
C99_OSL04
C100_OSL05
C101_OSL06
C102_OSL07
C103_OSL08
C104_OSL09
C105_OSL10
C106_OSL11
C107_OSL12
C108_OSL13
C109_OSL14
C110_OSL15
C111_OSL16
C112_MSLVT
C113_MSL01
C114_MSL02
C115_MSL03
C116_MSL04
C117_MSL05
C118_MSL06
C119_MSL07
C120_MSL08
C121_MSL09
C122_MSL10
C123_MSL11
C124_MSL12
C125_MSL13
C126_MSL14
C127_MSL15
C128_MSL16
C129_TIMESTAMP
C130_CURIN
C131_CURHA
C132_WAERS
INTO wa_final_string
SEPARATED BY lv_delimiter.
IF sy-tabix EQ 1 AND lv_cnt EQ 1.
CONCATENATE wa_final_string
lv_delimiter INTO wa_final_string.
ELSE.
CONCATENATE '' lv_delimiter wa_final_string
lv_delimiter INTO wa_final_string.
ENDIF.
APPEND wa_final_string TO gt_result.
CLEAR : C1_BUTXT,
C2_FIKRS,
C3_WAERS,
C4_KTOPL,
C5_LTEXT,
C6_RBUKRS,
C7_RBUSA,
C8_RFAREA,
C9_SEGMENT,
C10_PRCTR,
C11_RASSC,
C12_RYEAR,
C13_SBUSA,
C14_SFAREA,
C15_PPRCTR,
C16_RPMAX,
C17_RACCT,
C18_RVERS,
C19_RLDNR,
C20_LOGSYS,
C21_COST_ELEM,
C22_RCNTR,
C23_KOKRS,
C24_HSL01,
C25_HSL02,
C26_HSL03,
C27_HSL04,
C28_HSL05,
C29_HSL06,
C30_HSL07,
C31_HSL08,
C32_HSL09,
C33_HSL10,
C34_HSL11,
C35_HSL12,
C36_HSL13,
C37_HSL14,
C38_HSL15,
C39_HSL16,
C40_DRCRK,
C41_HSLVT,
C42_TSLVT,
C43_KSLVT,
C44_RTCUR,
C45_TSL05,
C46_TSL01,
C47_TSL06,
C48_TSL02,
C49_TSL04,
C50_TSL03,
C51_TSL07,
C52_TSL12,
C53_TSL08,
C54_TSL11,
C55_TSL09,
C56_TSL10,
C57_TSL13,
C58_TSL16,
C59_TSL14,
C60_TSL15,
C61_RRCTY,
C62_KSL11,
C63_KSL02,
C64_KSL10,
C65_KSL15,
C66_KSL07,
C67_KSL09,
C68_KSL03,
C69_KSL08,
C70_KSL14,
C71_KSL04,
C72_KSL05,
C73_KSL01,
C74_KSL12,
C75_KSL13,
C76_KSL06,
C77_KSL16,
C78_RCLNT,
C79_MWAER,
C80_OBJNR00,
C81_OBJNR01,
C82_OBJNR02,
C83_OBJNR03,
C84_OBJNR04,
C85_OBJNR05,
C86_OBJNR06,
C87_OBJNR07,
C88_OBJNR08,
C89_ACTIV,
C90_RMVCT,
C91_RUNIT,
C92_AWTYP,
C93_SCNTR,
C94_PSEGMENT,
C95_OSLVT,
C96_OSL01,
C97_OSL02,
C98_OSL03,
C99_OSL04,
C100_OSL05,
C101_OSL06,
C102_OSL07,
C103_OSL08,
C104_OSL09,
C105_OSL10,
C106_OSL11,
C107_OSL12,
C108_OSL13,
C109_OSL14,
C110_OSL15,
C111_OSL16,
C112_MSLVT,
C113_MSL01,
C114_MSL02,
C115_MSL03,
C116_MSL04,
C117_MSL05,
C118_MSL06,
C119_MSL07,
C120_MSL08,
C121_MSL09,
C122_MSL10,
C123_MSL11,
C124_MSL12,
C125_MSL13,
C126_MSL14,
C127_MSL15,
C128_MSL16,
C129_TIMESTAMP,
C130_CURIN,
C131_CURHA,
C132_WAERS.
ENDLOOP.
free : tt_final_target.
IF NOT gt_result IS INITIAL.
 CLEAR wa_result.
 LOOP AT gt_result INTO wa_result.
  TRANSFER wa_result TO lv_path.
 ENDLOOP.
ENDIF.
DESCRIBE TABLE gt_result LINES lv_cnt.
WRITE : 'No of records in final table is :',lv_cnt.
REFRESH gt_result.
*END of main loop for batching
ENDDO.
*Close dataset
CLOSE DATASET lv_path.
**Error Handling for closing dataset
IF SY-SUBRC NE 0.
CLEAR et_file_return.
et_file_return-type = 'E'.
et_file_return-message =
'Error occured in closing the dataset'.
APPEND et_file_return.
ENDIF.
CLOSE CURSOR lv_T001_dbcur.
DESCRIBE TABLE gt_result LINES lv_cnt.
WRITE : 'No of records in final table is :',lv_cnt.
**Error Handling for closing cursor
*IF SY-SUBRC NE 0.
*CLEAR et_file_return.
*et_file_return-type = 'E'.
*et_file_return-message =
*'Error occured while close cursor command'.
*APPEND et_file_return.
*ENDIF.



ENDFUNCTION.
